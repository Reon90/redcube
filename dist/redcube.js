!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("redcube",[],t):"object"==typeof exports?exports.redcube=t():e.redcube=t()}(window,function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,r),s.l=!0,s.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)r.d(n,s,function(t){return e[t]}.bind(null,s));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=16)}([function(e,t){e.exports="#version 300 es\r\nlayout (location = 0) in vec2 pos;\r\n\r\nout vec2 uv;\r\n\r\nvoid main() {\r\n    uv = pos * 0.5 + 0.5;\r\n    gl_Position = vec4(pos, 0.0, 1.0); \r\n}\r\n"},function(e,t){e.exports="#version 300 es\r\nprecision highp float;\r\n\r\nin vec2 uv;\r\nout vec4 color;\r\n\r\nuniform vec2 denom;\r\nuniform sampler2D uTexture;\r\n\r\nconst float weight[5] = float[] (0.227027, 0.1945946, 0.1216216, 0.054054, 0.016216);\r\n\r\nvoid main() {             \r\n    vec2 offset = 1.0 / vec2(textureSize(uTexture, 0));\r\n    vec3 result = texture(uTexture, uv).rgb * weight[0];\r\n\r\n    for (int i = 1; i < 5; ++i) {\r\n        result += texture(uTexture, uv + denom * (offset * float(i))).rgb * weight[i];\r\n        result += texture(uTexture, uv - denom * (offset * float(i))).rgb * weight[i];\r\n    }\r\n\r\n    color = vec4(result, 1.0);\r\n}\r\n"},function(e,t){e.exports="data:image/jpeg;base64,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"},function(e,t){e.exports="#version 300 es\r\nprecision highp float;\r\n\r\nlayout (location = 0) in vec3 inPosition;\r\nlayout (location = 1) in vec2 inUV;\r\n\r\nuniform mat4 MVPMatrix;\r\n\r\nout vec2 outUV;\r\n\r\nvoid main() {\r\n\toutUV = inUV;\r\n    gl_Position = MVPMatrix * vec4(inPosition, 1.0);\r\n}\r\n"},function(e,t){e.exports="#version 300 es\r\nprecision highp float;\r\n\r\nin vec2 outUV;\r\nlayout (location = 0) out vec4 color;\r\n\r\nuniform sampler2D diffuse;\r\nuniform float level;\r\n\r\nvoid main() {\r\n    vec2 texelSize = 1.0 / vec2(textureSize(diffuse, 0));\r\n    vec3 result = vec3(0.0);\r\n    for (int x = -2; x < 2; ++x) {\r\n        for (int y = -2; y < 2; ++y) {\r\n            vec2 offset = vec2(float(x), float(y)) * texelSize;\r\n            result += textureLod(diffuse, outUV + offset, level).rgb;\r\n        }\r\n    }\r\n    color = vec4(result / 16.0, 1.0);\r\n}\r\n"},function(e,t){e.exports="#version 300 es\r\nprecision highp float;\r\n\r\nlayout (location = 0) in vec3 inPosition;\r\nlayout (location = 1) in vec3 inNormal;\r\nlayout (location = 2) in vec2 inUV;\r\nlayout (location = 3) in vec4 inJoint;\r\nlayout (location = 4) in vec4 inWeight;\r\nlayout (location = 5) in vec4 inTangent;\r\n\r\nout vec2 outUV;\r\nout vec3 outPosition;\r\nout vec4 outPositionView;\r\n#ifdef TANGENT\r\n    out mat3 outTBN;\r\n#else\r\n    out vec3 outNormal;\r\n#endif\r\n\r\nuniform Matrices {\r\n    mat4 model;\r\n    mat4 normalMatrix;\r\n    mat4 view;\r\n    mat4 projection;\r\n    mat4 light;\r\n    //mat4 ortho;\r\n    float isShadow;\r\n};\r\n\r\n#ifdef JOINTNUMBER\r\nuniform Skin {\r\n    mat4 joint[JOINTNUMBER];\r\n};\r\n#endif\r\n\r\nvoid main() {\r\n    #ifdef JOINTNUMBER\r\n        mat4 skin = inWeight.x * joint[int(inJoint.x)];\r\n        skin += inWeight.y * joint[int(inJoint.y)];\r\n        skin += inWeight.z * joint[int(inJoint.z)];\r\n        skin += inWeight.w * joint[int(inJoint.w)];\r\n    #else\r\n        mat4 skin = mat4(1.0);\r\n    #endif\r\n\r\n    outUV = inUV;\r\n    #ifdef TANGENT\r\n        vec3 normalW = normalize(vec3(model * vec4(inNormal.xyz, 0.0)));\r\n        vec3 tangentW = normalize(vec3(model * vec4(inTangent.xyz, 0.0)));\r\n        vec3 bitangentW = cross(normalW, tangentW) * inTangent.w;\r\n        outTBN = mat3(tangentW, bitangentW, normalW);\r\n    #else\r\n        outNormal = normalize(mat3(normalMatrix) * mat3(skin) * inNormal);\r\n    #endif\r\n    outPosition = vec3(model * skin * vec4(inPosition, 1.0));\r\n    outPositionView = projection * light * model * skin * vec4(inPosition, 1.0);\r\n    if (isShadow == 1.0) {\r\n        gl_Position = projection * light * model * skin * vec4(inPosition, 1.0);\r\n    } else {\r\n        gl_Position = projection * view * model * skin * vec4(inPosition, 1.0);\r\n    }\r\n}\r\n"},function(e,t){e.exports="#version 300 es\r\nprecision highp float;\r\n\r\nin vec2 outUV;\r\nin vec3 outPosition;\r\nin vec4 outPositionView;\r\n#ifdef TANGENT\r\n    in mat3 outTBN;\r\n#else\r\n    in vec3 outNormal;\r\n#endif\r\n\r\nlayout (location = 0) out vec4 color;\r\nlayout (location = 1) out vec3 normalColor;\r\n\r\nuniform Material {\r\n    vec4 baseColorFactor;\r\n    vec3 lightPos;\r\n    vec3 viewPos;\r\n};\r\nuniform sampler2D baseColorTexture;\r\nuniform sampler2D metallicRoughnessTexture;\r\nuniform sampler2D normalTexture;\r\nuniform sampler2D emissiveTexture;\r\nuniform sampler2D occlusionTexture;\r\n\r\nuniform sampler2D depthTexture;\r\n\r\nconst float PI = 3.14159265359;\r\nconst float ambientStrength = 0.1;\r\nconst float specularStrength = 2.5;\r\nconst float specularPower = 32.0;\r\nconst vec3 lightColor = vec3(1.0, 1.0, 1.0);\r\nconst vec3 emissiveFactor = vec3(1.0, 1.0, 1.0);\r\nconst float gamma = 2.2;\r\n\r\nfloat ShadowCalculation(vec4 fragPosLightSpace, float bias) {\r\n    vec3 projCoords = fragPosLightSpace.xyz / fragPosLightSpace.w;\r\n    projCoords = projCoords * 0.5 + 0.5;\r\n    float closestDepth = texture(depthTexture, projCoords.xy).r; \r\n    float currentDepth = projCoords.z;\r\n    float shadow = currentDepth - bias > closestDepth ? 0.5 : 0.0;\r\n\r\n    return shadow;\r\n}\r\n\r\nvec3 srgbToLinear(vec4 srgbIn) {\r\n    return pow(srgbIn.rgb, vec3(2.2));\r\n}\r\n\r\nfloat DistributionGGX(vec3 N, vec3 H, float roughness) {\r\n    float a = roughness*roughness;\r\n    float a2 = max(a*a, 0.0001);\r\n    float NdotH = max(dot(N, H), 0.0);\r\n    float NdotH2 = NdotH*NdotH;\r\n\r\n    float nom   = a2;\r\n    float denom = (NdotH2 * (a2 - 1.0) + 1.0);\r\n    denom = PI * denom * denom;\r\n\r\n    return nom / max(denom, 0.0001);\r\n}\r\n\r\nfloat GeometrySchlickGGX(float NdotV, float roughness) {\r\n    float r = (roughness + 1.0);\r\n    float k = (r*r) / 8.0;\r\n\r\n    float nom   = NdotV;\r\n    float denom = NdotV * (1.0 - k) + k;\r\n\r\n    return nom / denom;\r\n}\r\n\r\nfloat GeometrySmith(vec3 N, vec3 V, vec3 L, float roughness) {\r\n    float NdotV = max(dot(N, V), 0.0);\r\n    float NdotL = max(dot(N, L), 0.0);\r\n    float ggx2 = GeometrySchlickGGX(NdotV, roughness);\r\n    float ggx1 = GeometrySchlickGGX(NdotL, roughness);\r\n\r\n    return ggx1 * ggx2;\r\n}\r\n\r\nvec3 fresnelSchlick(float cosTheta, vec3 F0) {\r\n    return F0 + (1.0 - F0) * pow(1.0 - cosTheta, 5.0);\r\n}\r\n\r\nvoid main() {\r\n    #ifdef BASECOLORTEXTURE\r\n        vec3 baseColor = srgbToLinear(texture(baseColorTexture, outUV));\r\n        float alpha = texture(baseColorTexture, outUV).a;\r\n    #else\r\n        vec3 baseColor = baseColorFactor.rgb;\r\n        float alpha = baseColorFactor.a;\r\n    #endif\r\n\r\n    #ifdef OCCLUSIONMAP\r\n        float ao = texture(occlusionTexture, outUV).r;\r\n    #endif\r\n\r\n    #ifdef METALROUGHNESSMAP\r\n        float roughness = texture(metallicRoughnessTexture, outUV).g;\r\n        float metallic = texture(metallicRoughnessTexture, outUV).b;\r\n    #endif\r\n\r\n    #ifdef TANGENT\r\n        #ifdef NORMALMAP\r\n            vec3 n = texture(normalTexture, outUV).rgb;\r\n            n = normalize(outTBN * (2.0 * n - 1.0));\r\n        #else\r\n            vec3 n = outTBN[2].xyz;\r\n        #endif\r\n    #else\r\n        vec3 n = outNormal;\r\n    #endif\r\n\r\n    vec3 viewDir = normalize(viewPos - outPosition);\r\n    vec3 lightDir = normalize(lightPos - outPosition);\r\n    vec3 H = normalize(viewDir + lightDir);\r\n    float distance = length(lightPos - outPosition);\r\n    float attenuation = 1.0 / (distance * distance);\r\n    vec3 radiance = lightColor * 2.0;\r\n    float shadowBias = max(0.05 * (1.0 - dot(n, lightDir)), 0.005);\r\n    float shadow = 1.0 - ShadowCalculation(outPositionView, shadowBias);\r\n\r\n    #ifdef USE_PBR\r\n        vec3 F0 = vec3(0.04); \r\n        F0 = mix(F0, baseColor, metallic);\r\n\r\n        vec3 light = vec3(0.0);\r\n\r\n        float NDF = DistributionGGX(n, H, roughness);        \r\n        float G = GeometrySmith(n, viewDir, lightDir, roughness);      \r\n        vec3 F = fresnelSchlick(max(dot(H, viewDir), 0.0), F0);       \r\n        \r\n        vec3 kS = F;\r\n        vec3 kD = vec3(1.0) - kS;\r\n        kD *= 1.0 - metallic;     \r\n        \r\n        vec3 nominator = NDF * G * F;\r\n        float denominator = 4.0 * max(dot(n, viewDir), 0.0) * max(dot(n, lightDir), 0.0);\r\n        vec3 specular = nominator / max(denominator, 0.001);  \r\n\r\n        float NdotL = max(dot(n, lightDir), 0.0);                \r\n        light += (kD * baseColor / PI + specular) * radiance * NdotL;\r\n\r\n        #ifdef OCCLUSIONMAP\r\n            vec3 ambient = vec3(0.03) * baseColor * ao;\r\n        #else\r\n            vec3 ambient = baseColor;\r\n        #endif\r\n        baseColor = ambient + light;\r\n\r\n        #ifdef EMISSIVEMAP\r\n            vec3 emissive = srgbToLinear(texture(emissiveTexture, outUV)) * emissiveFactor;\r\n            baseColor.rgb += emissive;\r\n        #endif\r\n\r\n        baseColor.rgb *= shadow;\r\n   \r\n        color = vec4(baseColor, 1.0);\r\n    #else\r\n        vec3 ambient = ambientStrength * lightColor;\r\n\r\n        float diff = max(dot(n, lightDir), 0.0);\r\n        vec3 diffuse = diff * lightColor;\r\n\r\n        vec3 reflectDir = reflect(-lightDir, n);\r\n        float spec = pow(max(dot(viewDir, reflectDir), 0.0), specularPower);\r\n        vec3 specular = specularStrength * spec * lightColor;\r\n\r\n        color = vec4(baseColor.rgb * (ambient + diffuse + specular) * shadow, alpha);\r\n    #endif\r\n\r\n    #ifdef TONE\r\n        color.rgb = pow(color.rgb, vec3(1.0 / gamma));\r\n    #endif\r\n\r\n    normalColor = n;\r\n}\r\n"},function(e,t){e.exports="#version 300 es\nprecision highp float;\n\nin vec2 uv;\nout float color;\n\nconst int kernelSize = 32;\nconst float radius = 2.5;\nconst float bias = 1.0;\nconst float power = 8.0;\n\nuniform sampler2D normBuff;\nuniform sampler2D depthBuff;\nuniform sampler2D noice;\nuniform vec2 noiseScale;\nuniform vec3 kernels[kernelSize];\nuniform mat4 proj;\nuniform mat4 projI;\nuniform float zFar;\nuniform float zNear;\n\nvec3 getPositionFromDepth(float depth) {\n\tvec4 clipSpaceLocation = vec4(0.0);\n\tclipSpaceLocation.xy = uv * 2.0 - 1.0;\n\tclipSpaceLocation.z = depth * 2.0 - 1.0;;\n\tclipSpaceLocation.w = 1.0;\n\tvec4 homogenousLocation = projI * clipSpaceLocation;\n\thomogenousLocation.xyz = homogenousLocation.xyz / homogenousLocation.w;\n\treturn homogenousLocation.xyz;\n}\n\nvoid main() {\n\tfloat depth = texture(depthBuff, uv).x;\n\tif ((2.0 * zNear) / (zFar + zNear - depth * (zFar - zNear)) > 0.99) {\n\t\tdiscard;\n\t}\n\n\tvec3 pos = getPositionFromDepth(depth);\n\tvec3 normal = normalize(texture(normBuff, uv).xyz);\n\tvec3 rvec = normalize(texture(noice, uv * noiseScale).xyz);\n\n\tvec3 tangent = normalize(rvec - normal * dot(rvec, normal));\n\tvec3 bitangent = cross(tangent, normal);\n\tmat3 rotate = mat3(tangent, bitangent, normal);\n\n\tfloat occlusion  = 0.0;\n\tfor (int i = 0; i < kernelSize; i++) {\n\t\tvec3 samplePos = rotate * kernels[i];\n\t\tsamplePos = pos + samplePos * radius;\n\n\t\tvec4 shift = proj * vec4(samplePos, 1.0);\n\t\tshift.xy /= shift.w;\n\t\tshift.xy = shift.xy * 0.5 + 0.5;\n\n\t\tfloat sampleDepth = getPositionFromDepth(texture(depthBuff, shift.xy).r).z;\n\n\t\tfloat distanceCheck = smoothstep(0.0, 1.0, radius / abs(pos.z - sampleDepth));\n\t\tocclusion  += (sampleDepth >= samplePos.z + bias ? 1.0 : 0.0) * distanceCheck;\n\t}\n\n\tocclusion = 1.0 - (occlusion / float(kernelSize));\n\tcolor = pow(occlusion, power);\n}\n"},function(e,t){e.exports="#version 300 es\r\nprecision highp float;\r\n\r\nin vec2 uv;\r\nout vec4 color;\r\n\r\nuniform sampler2D diff;\r\n\r\nconst vec3 hdrColor = vec3(0.2126, 0.7152, 0.0722);\r\nconst float brightnessThreshold = 0.8;\r\n\r\nvoid main() {\r\n    vec3 c = texture(diff, uv).rgb;\r\n    float brightness = dot(c, hdrColor);\r\n    if (brightness > brightnessThreshold) {\r\n        color = vec4(c, 1.0);\r\n    } else {\r\n        color = vec4(0.0, 0.0, 0.0, 1.0);\r\n    }\r\n}\r\n"},function(e,t){e.exports="#version 300 es\r\nprecision highp float;\r\n\r\nin vec2 uv;\r\n// in vec4 tPos1;\r\n// in vec4 tPos2;\r\nin vec4 vPosLight1;\r\nin vec4 vPosLight2;\r\nout float color;\r\n\r\nuniform sampler2D lightTexture;\r\nuniform sampler2D cameraTexture;\r\n\r\nuniform mat4 proj;\r\nuniform mat4 light;\r\nuniform mat4 view;\r\n\r\nconst int samples = 80;\r\n\r\nvoid main() {\r\n    float stp = 1.0/float(samples);\r\n\tfloat k = 0.0;\r\n    float d = 0.0;\r\n\r\n    for (int i = 0; i < samples; i++) {\r\n\r\n        //vec4 vPos = mix(tPos1,tPos2,k);\r\n        vec4 vPosLight = mix(vPosLight1,vPosLight2,k);\r\n        k += stp;\r\n\r\n        vec3 ShadowTexC = (vPosLight.xyz/vPosLight.w) * 0.5 + 0.5;\r\n\r\n        float add = step(texture(lightTexture, ShadowTexC.xy).x, ShadowTexC.z);\r\n        d += add*stp;\r\n\t}\r\n\r\n    color = min((1.0 - d), 0.2);\r\n}\r\n"},function(e,t){e.exports="#version 300 es\r\nprecision highp float;\r\n\r\nlayout (location = 0) in vec2 pos;\r\n\r\nout vec2 uv;\r\nout vec4 vPosLight1;\r\nout vec4 vPosLight2;\r\n\r\nuniform mat4 proj;\r\nuniform mat4 light;\r\nuniform mat4 Iproj;\r\nuniform mat4 Iview;\r\n\r\nvoid main() {\r\n    vec4 p1 = Iview * Iproj * vec4(pos, -1.0/4.0, 1.0);\r\n    vec4 p2 = Iview * Iproj * vec4(pos, 1.0/4.0, 1.0);\r\n\r\n\tvPosLight1 = proj * light * p1;\r\n    vPosLight2 = proj * light * p2;\r\n\r\n\tuv = pos * 0.5 + 0.5;\r\n\tgl_Position = vec4(pos, 0.0, 1.0);\r\n}\r\n"},function(e,t){e.exports="#version 300 es\r\nprecision highp float;\r\n\r\nin vec2 uv;\r\nout vec4 color;\r\n\r\nuniform sampler2D original;\r\nuniform sampler2D position;\r\nuniform sampler2D normal;\r\nuniform sampler2D ssao;\r\nuniform sampler2D bloom;\r\nuniform sampler2D depth;\r\nuniform sampler2D preDepth;\r\nuniform sampler2D light;\r\n\r\nconst float gamma = 2.2;\r\n\r\nvoid main() {\r\n    vec3 c = texture(original, uv).rgb;\r\n    #ifdef BLOOM\r\n        c += texture(bloom, uv).rgb;\r\n    #endif\r\n    #ifdef SSAO\r\n        c *= texture(ssao, uv).r;\r\n    #endif\r\n    #ifdef LIGHT\r\n        c += texture(light, uv).r;\r\n    #endif\r\n\r\n    c.rgb = pow(c.rgb, vec3(1.0 / gamma));\r\n\r\n    color = vec4(c, 1.0);\r\n}\r\n"},function(e,t){e.exports="#version 300 es\r\nprecision highp float;\r\nprecision highp sampler3D;\r\n\r\nlayout (location = 0) in vec3 inPosition;\r\nout float depth;\r\n\r\nuniform sampler2D light;\r\nuniform mat4 MVPMatrix;\r\n\r\nvoid main() {\r\n    gl_PointSize = 1.0;\r\n    vec4 point = MVPMatrix * vec4(inPosition, 1.0);\r\n    vec2 uv = (point.xy / point.w) * 0.5 + 0.5;\r\n    depth = texture(light, uv).r;\r\n    gl_Position = point;\r\n}\r\n"},function(e,t){e.exports="#version 300 es\r\nprecision highp float;\r\n\r\nlayout (location = 0) out vec4 color;\r\nin float depth;\r\n\r\nvoid main() {\r\n    //color = vec4(0.0, 0.0, 0.8, 1.0) * texture( image, gl_PointCoord );\r\n    if (depth < 0.05) {\r\n        discard;\r\n    }\r\n    color = vec4(1.0, 1.0, 1.0, 1.0);\r\n}\r\n"},function(e,t){e.exports="#version 300 es\r\nprecision highp float;\r\n\r\nlayout (location = 0) out vec4 color;\r\n\r\nvoid main() {\r\n    //color = vec4(0.0, 0.0, 0.8, 1.0) * texture( image, gl_PointCoord );\r\n    color = vec4(1.0, 1.0, 1.0, 1.0);\r\n}\r\n"},function(e,t){e.exports="#version 300 es\r\nprecision highp float;\r\nprecision highp sampler3D;\r\n\r\nlayout(location = 0) in vec3 a_position;\r\nlayout(location = 1) in vec3 a_velocity;\r\nlayout(location = 2) in float a_spawntime;\r\nlayout(location = 3) in float a_lifetime;\r\n\r\nout vec3 v_position;\r\nout vec3 v_velocity;\r\nout float v_spawntime;\r\nout float v_lifetime;\r\n\r\nuniform float u_time;\r\nuniform sampler3D noize;\r\nuniform float count;\r\n\r\nfloat rand(vec3 co) {\r\n    return texture(noize, co).r;\r\n}\r\n\r\nconst float lifetime = 15000.0;\r\nconst vec3 center = vec3(0.5, 0.5, 0.5);\r\nconst vec3 acceleration = vec3(0.0, 0.0, 0.0);\r\n\r\nvoid main() {\r\n    if (a_spawntime == 0.0 || (u_time - a_spawntime) > a_lifetime) {\r\n        float x = float(gl_InstanceID) / count;\r\n        float t = u_time/1000.0 * x;\r\n        v_position = vec3(\r\n            rand(vec3(x, x, t)),\r\n            rand(vec3(1.0 - x, 1.0 - x, t)),\r\n            rand(vec3(x, 0.5, t))\r\n        ) - center;\r\n        v_velocity = vec3(\r\n            rand(vec3(x, x, t)),\r\n            rand(vec3(1.0 - x, 1.0 - x, t)),\r\n            rand(vec3(x, 0.5, t))\r\n        ) - center;\r\n        v_spawntime = u_time;\r\n        v_lifetime = rand(vec3(x, 0.5, t)) * lifetime;\r\n    } else {\r\n        v_velocity = a_velocity + 0.01 * acceleration;\r\n        v_position = a_position + 0.01 * v_velocity;\r\n        v_spawntime = a_spawntime;\r\n        v_lifetime = a_lifetime;\r\n    }\r\n}\r\n"},function(e,t,r){"use strict";r.r(t);class n{constructor(e){let t,r,n;if(e&&"object"==typeof e&&e.hasOwnProperty("elements")){for(r=e.elements,n=new Float32Array(16),t=0;t<16;++t)n[t]=r[t];this.elements=n}else this.elements=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}getScaleZ(){const e=this.elements,t=e[8],r=e[9],n=e[10];return Math.sqrt(t*t+r*r+n*n)}set(e){let t,r,n;if((r=e)!==(n=this.elements)){for(t=0;t<16;++t)n[t]=r[t];return this}}multiply(e){return this.concat(e),this}concat({elements:e}){let t,r,n,s,i,o,a,l;if(r=this.elements,n=this.elements,r===(s=e))for(s=new Float32Array(16),t=0;t<16;++t)s[t]=r[t];for(t=0;t<4;t++)i=n[t],o=n[t+4],a=n[t+8],l=n[t+12],r[t]=i*s[0]+o*s[1]+a*s[2]+l*s[3],r[t+4]=i*s[4]+o*s[5]+a*s[6]+l*s[7],r[t+8]=i*s[8]+o*s[9]+a*s[10]+l*s[11],r[t+12]=i*s[12]+o*s[13]+a*s[14]+l*s[15];return this}setInverseOf({elements:e}){let t,r,n,s,i;if(r=e,n=this.elements,(s=new Float32Array(16))[0]=r[5]*r[10]*r[15]-r[5]*r[11]*r[14]-r[9]*r[6]*r[15]+r[9]*r[7]*r[14]+r[13]*r[6]*r[11]-r[13]*r[7]*r[10],s[4]=-r[4]*r[10]*r[15]+r[4]*r[11]*r[14]+r[8]*r[6]*r[15]-r[8]*r[7]*r[14]-r[12]*r[6]*r[11]+r[12]*r[7]*r[10],s[8]=r[4]*r[9]*r[15]-r[4]*r[11]*r[13]-r[8]*r[5]*r[15]+r[8]*r[7]*r[13]+r[12]*r[5]*r[11]-r[12]*r[7]*r[9],s[12]=-r[4]*r[9]*r[14]+r[4]*r[10]*r[13]+r[8]*r[5]*r[14]-r[8]*r[6]*r[13]-r[12]*r[5]*r[10]+r[12]*r[6]*r[9],s[1]=-r[1]*r[10]*r[15]+r[1]*r[11]*r[14]+r[9]*r[2]*r[15]-r[9]*r[3]*r[14]-r[13]*r[2]*r[11]+r[13]*r[3]*r[10],s[5]=r[0]*r[10]*r[15]-r[0]*r[11]*r[14]-r[8]*r[2]*r[15]+r[8]*r[3]*r[14]+r[12]*r[2]*r[11]-r[12]*r[3]*r[10],s[9]=-r[0]*r[9]*r[15]+r[0]*r[11]*r[13]+r[8]*r[1]*r[15]-r[8]*r[3]*r[13]-r[12]*r[1]*r[11]+r[12]*r[3]*r[9],s[13]=r[0]*r[9]*r[14]-r[0]*r[10]*r[13]-r[8]*r[1]*r[14]+r[8]*r[2]*r[13]+r[12]*r[1]*r[10]-r[12]*r[2]*r[9],s[2]=r[1]*r[6]*r[15]-r[1]*r[7]*r[14]-r[5]*r[2]*r[15]+r[5]*r[3]*r[14]+r[13]*r[2]*r[7]-r[13]*r[3]*r[6],s[6]=-r[0]*r[6]*r[15]+r[0]*r[7]*r[14]+r[4]*r[2]*r[15]-r[4]*r[3]*r[14]-r[12]*r[2]*r[7]+r[12]*r[3]*r[6],s[10]=r[0]*r[5]*r[15]-r[0]*r[7]*r[13]-r[4]*r[1]*r[15]+r[4]*r[3]*r[13]+r[12]*r[1]*r[7]-r[12]*r[3]*r[5],s[14]=-r[0]*r[5]*r[14]+r[0]*r[6]*r[13]+r[4]*r[1]*r[14]-r[4]*r[2]*r[13]-r[12]*r[1]*r[6]+r[12]*r[2]*r[5],s[3]=-r[1]*r[6]*r[11]+r[1]*r[7]*r[10]+r[5]*r[2]*r[11]-r[5]*r[3]*r[10]-r[9]*r[2]*r[7]+r[9]*r[3]*r[6],s[7]=r[0]*r[6]*r[11]-r[0]*r[7]*r[10]-r[4]*r[2]*r[11]+r[4]*r[3]*r[10]+r[8]*r[2]*r[7]-r[8]*r[3]*r[6],s[11]=-r[0]*r[5]*r[11]+r[0]*r[7]*r[9]+r[4]*r[1]*r[11]-r[4]*r[3]*r[9]-r[8]*r[1]*r[7]+r[8]*r[3]*r[5],s[15]=r[0]*r[5]*r[10]-r[0]*r[6]*r[9]-r[4]*r[1]*r[10]+r[4]*r[2]*r[9]+r[8]*r[1]*r[6]-r[8]*r[2]*r[5],0===(i=r[0]*s[0]+r[1]*s[4]+r[2]*s[8]+r[3]*s[12]))return this;for(i=1/i,t=0;t<16;t++)n[t]=s[t]*i;return this}invert(){return this.setInverseOf(this)}makeOrthographic(e,t,r,n,s,i){var o=this.elements,a=1/(t-e),l=1/(r-n),h=1/(i-s),c=(t+e)*a,u=(r+n)*l,m=(i+s)*h;return o[0]=2*a,o[4]=0,o[8]=0,o[12]=-c,o[1]=0,o[5]=2*l,o[9]=0,o[13]=-u,o[2]=0,o[6]=0,o[10]=-2*h,o[14]=-m,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this}setOrtho(e,t,r,n){let s,i,o,a;return i=1/e,o=1/t,a=2/(r-n),(s=this.elements)[0]=i,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=o,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=a,s[11]=(n+r)/(r-n),s[12]=0,s[13]=0,s[14]=0,s[15]=1,this}setPerspective(e,t,r,n){let s,i,o,a;if(r===n||0===t)throw"null frustum";if(r<=0)throw"near <= 0";if(n<=0)throw"far <= 0";if(e=Math.PI*e/180/2,0===(o=Math.sin(e)))throw"null frustum";return i=1/(n-r),a=Math.cos(e)/o,(s=this.elements)[0]=a/t,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=a,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=-(n+r)*i,s[11]=-1,s[12]=0,s[13]=0,s[14]=-2*r*n*i,s[15]=0,this}perspective(e,t,r,s){return this.concat((new n).setPerspective(e,t,r,s))}multiplyVector4({elements:e}){const t=this.elements,r=e,n=new i,s=n.elements;return s[0]=r[0]*t[0]+r[1]*t[4]+r[2]*t[8]+r[3]*t[12],s[1]=r[0]*t[1]+r[1]*t[5]+r[2]*t[9]+r[3]*t[13],s[2]=r[0]*t[2]+r[1]*t[6]+r[2]*t[10]+r[3]*t[14],s[3]=r[0]*t[3]+r[1]*t[7]+r[2]*t[11]+r[3]*t[15],n}scale(e){const t=e.elements[0],r=e.elements[1],n=e.elements[2],s=this.elements;return s[0]*=t,s[4]*=r,s[8]*=n,s[1]*=t,s[5]*=r,s[9]*=n,s[2]*=t,s[6]*=r,s[10]*=n,s[3]*=t,s[7]*=r,s[11]*=n,this}setTranslate(e){const t=this.elements,r=e.elements[0],n=e.elements[1],s=e.elements[2];return t[12]=r,t[13]=n,t[14]=s,t[15]=1,this}translate(e,t,r){const n=this.elements;return n[12]+=n[0]*e+n[4]*t+n[8]*r,n[13]+=n[1]*e+n[5]*t+n[9]*r,n[14]+=n[2]*e+n[6]*t+n[10]*r,n[15]+=n[3]*e+n[7]*t+n[11]*r,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],n=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,r,n))}makeRotationAxis(e,t){const r=this.elements,n=Math.cos(t),s=Math.sin(t),i=1-n,o=e.elements[0],a=e.elements[1],l=e.elements[2],h=i*o,c=i*a;return r[0]=h*o+n,r[1]=h*a-s*l,r[2]=h*l+s*a,r[3]=0,r[4]=h*a+s*l,r[5]=c*a+n,r[6]=c*l-s*o,r[7]=0,r[8]=h*l-s*a,r[9]=c*l+s*o,r[10]=i*l*l+n,r[11]=0,r[15]=1,this}makeRotationFromQuaternion(e){const t=this.elements,r=e[0],n=e[1],s=e[2],i=e[3],o=r+r,a=n+n,l=s+s,h=r*o,c=r*a,u=r*l,m=n*a,f=n*l,d=s*l,p=i*o,A=i*a,T=i*l;return t[0]=1-(m+d),t[4]=c-T,t[8]=u+A,t[1]=c+T,t[5]=1-(h+d),t[9]=f-p,t[2]=u-A,t[6]=f+p,t[10]=1-(h+m),this}transpose(){let e,t;return t=(e=this.elements)[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}}class s{constructor(e){const t=new Float32Array(3);e&&"object"==typeof e&&(t[0]=e[0],t[1]=e[1],t[2]=e[2]),this.elements=t}applyQuaternion({elements:e}){const t=this.elements[0],r=this.elements[1],n=this.elements[2],s=e[0],i=e[1],o=e[2],a=e[3],l=a*t+i*n-o*r,h=a*r+o*t-s*n,c=a*n+s*r-i*t,u=-s*t-i*r-o*n;return this.elements[0]=l*a+u*-s+h*-o-c*-i,this.elements[1]=h*a+u*-i+c*-s-l*-o,this.elements[2]=c*a+u*-o+l*-i-h*-s,this}normalize(){const e=this.elements,t=e[0],r=e[1],n=e[2];let s=Math.sqrt(t*t+r*r+n*n);return s?1==s?this:(s=1/s,e[0]=t*s,e[1]=r*s,e[2]=n*s,this):(e[0]=0,e[1]=0,e[2]=0,this)}add(e){const t=this.elements;return e=e.elements,t[0]=t[0]+e[0],t[1]=t[1]+e[1],t[2]=t[2]+e[2],this}addS(e){const t=this.elements;return t[0]=t[0]+e,t[1]=t[1]+e,t[2]=t[2]+e,this}scale(e){const t=this.elements;return t[0]=t[0]*e,t[1]=t[1]*e,t[2]=t[2]*e,this}distanceToSquared(e,t,r){const n=this.elements[0]-e,s=this.elements[1]-t,i=this.elements[2]-r;return n*n+s*s+i*i}subtract(e){const t=this.elements;return e=e.elements,t[0]=t[0]-e[0],t[1]=t[1]-e[1],t[2]=t[2]-e[2],this}divideScalar(e){return this.scale(1/e)}applyMatrix4({elements:e}){const t=this.elements[0],r=this.elements[1],n=this.elements[2],s=e;this.elements[0]=s[0]*t+s[4]*r+s[8]*n+s[12],this.elements[1]=s[1]*t+s[5]*r+s[9]*n+s[13],this.elements[2]=s[2]*t+s[6]*r+s[10]*n+s[14];const i=s[3]*t+s[7]*r+s[11]*n+s[15];return this.divideScalar(i)}lerp(e,t,r){const n=this.elements,s=e[0],i=e[1],o=e[2];return n[0]=s+r*(t[0]-s),n[1]=i+r*(t[1]-i),n[2]=o+r*(t[2]-o),this}lengthSq(){return this.elements[0]*this.elements[0]+this.elements[1]*this.elements[1]+this.elements[2]*this.elements[2]}multiply({elements:e}){return this.elements[0]*=e[0],this.elements[1]*=e[1],this.elements[2]*=e[2],this}static angle(e,t){const r=new s(e.elements),n=new s(t.elements);r.normalize(),n.normalize();const i=s.dot(r,n);return i>1?0:Math.acos(i)}static cross(e,t){e=e.elements,t=t.elements;const r=e[0],n=e[1],i=e[2],o=t[0],a=t[1],l=t[2],h=new s;return h.elements[0]=n*l-i*a,h.elements[1]=i*o-r*l,h.elements[2]=r*a-n*o,h}static dot(e,t){return e=e.elements,t=t.elements,e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}}class i{constructor(e){const t=new Float32Array(4);e&&"object"==typeof e&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]),this.elements=t}set(e){const t=this.elements;return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],this}add(e){const t=this.elements;return e=e.elements,t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=t[3]+e[3],this}normalize(){const e=this.elements[0],t=this.elements[1],r=this.elements[2],n=this.elements[3];let s=e*e+t*t+r*r+n*n;return s>0&&(s=1/Math.sqrt(s),this.elements[0]=e*s,this.elements[1]=t*s,this.elements[2]=r*s,this.elements[3]=n*s),this}setFromRotationMatrix({elements:e}){const t=e,r=t[0],n=t[4],s=t[8],i=t[1],o=t[5],a=t[9],l=t[2],h=t[6],c=t[10],u=r+o+c;let m;return u>0?(m=.5/Math.sqrt(u+1),this.elements[3]=.25/m,this.elements[0]=(h-a)*m,this.elements[1]=(s-l)*m,this.elements[2]=(i-n)*m):r>o&&r>c?(m=2*Math.sqrt(1+r-o-c),this.elements[3]=(h-a)/m,this.elements[0]=.25*m,this.elements[1]=(n+i)/m,this.elements[2]=(s+l)/m):o>c?(m=2*Math.sqrt(1+o-r-c),this.elements[3]=(s-l)/m,this.elements[0]=(n+i)/m,this.elements[1]=.25*m,this.elements[2]=(a+h)/m):(m=2*Math.sqrt(1+c-r-o),this.elements[3]=(i-n)/m,this.elements[0]=(s+l)/m,this.elements[1]=(a+h)/m,this.elements[2]=.25*m),this}lerp(e,t,r){const n=this.elements,s=e[0],i=e[1],o=e[2],a=e[3];return n[0]=s+r*(t[0]-s),n[1]=i+r*(t[1]-i),n[2]=o+r*(t[2]-o),n[3]=a+r*(t[3]-a),this}}class o{constructor(e){const t=new Float32Array(2);e&&"object"==typeof e&&(t[0]=e[0],t[1]=e[1]),this.elements=t}subtract(e){const t=this.elements;return e=e.elements,t[0]=t[0]-e[0],t[1]=t[1]-e[1],this}lerp(e,t,r){const n=this.elements,s=e[0],i=e[1];return n[0]=s+r*(t[0]-s),n[1]=i+r*(t[1]-i),this}}function a(e){const t=[new i,new i,new i,new i,new i,new i],r=e.elements;let n=r[0],s=r[1],o=r[2],a=r[3],l=r[4],h=r[5],c=r[6],u=r[7],m=r[8],f=r[9],d=r[10],p=r[11],A=r[12],T=r[13],E=r[14],b=r[15];return t[0].set([a-n,u-l,p-m,b-A]).normalize(),t[1].set([a+n,u+l,p+m,b+A]).normalize(),t[2].set([a+s,u+h,p+f,b+T]).normalize(),t[3].set([a-s,u-h,p-f,b-T]).normalize(),t[4].set([a-o,u-c,p-d,b-E]).normalize(),t[5].set([a+o,u+c,p+d,b+E]).normalize(),t}class l{constructor(e,t){this.uuid=Math.floor(Date.now()*Math.random()),this.name=e,this.children=[],this.matrix=new n,this.matrixWorld=new n,this.parent=t}setPosition(e,t,r){t&&this.matrix.makeRotationFromQuaternion(t),r&&this.matrix.scale(new s(r)),e&&this.matrix.setTranslate(new s(e))}setMatrix(e){this.matrix.set(e)}setMatrixWorld(e){this.matrixWorld.set(e)}updateMatrix(){const e=new n;e.multiply(this.parent.matrixWorld),e.multiply(this.matrix),this.setMatrixWorld(e.elements)}}class h extends l{constructor(e,t){super(e,t),this.geometry={boundingSphere:{center:new s,radius:null,min:null,max:null},UBO:null,VAO:null,indicesBuffer:null,attributes:null,targets:null,blend:null,uniforms:null,SKIN:null},this.material={blend:null,uniforms:null,alphaMode:null,UBO:null,pbrMetallicRoughness:null},this.program=null,this.defines=null,this.mode=4}setBlend(e){this.material.blend=e}setMaterial(e){this.material=e,this.material.uniforms={baseColorTexture:null,metallicRoughnessTexture:null,normalTexture:null,occlusionTexture:null,emissiveTexture:null}}draw(e,{camera:t,light:r,preDepthTexture:s,fakeDepth:i,needUpdateView:o,needUpdateProjection:a},l,h){if(e.useProgram(this.program),e.bindVertexArray(this.geometry.VAO),e.bindBufferBase(e.UNIFORM_BUFFER,0,this.geometry.UBO),this.reflow){const t=new n(this.matrixWorld);t.invert().transpose();const r=new Float32Array(32);r.set(this.matrixWorld.elements),r.set(t.elements,16),e.bufferSubData(e.UNIFORM_BUFFER,0,r)}if(o&&(e.bufferSubData(e.UNIFORM_BUFFER,32*Float32Array.BYTES_PER_ELEMENT,t.matrixWorldInvert.elements),e.bufferSubData(e.UNIFORM_BUFFER,64*Float32Array.BYTES_PER_ELEMENT,r.matrixWorldInvert.elements)),a&&e.bufferSubData(e.UNIFORM_BUFFER,48*Float32Array.BYTES_PER_ELEMENT,t.projection.elements),e.bufferSubData(e.UNIFORM_BUFFER,80*Float32Array.BYTES_PER_ELEMENT,new Float32Array([h?1:0])),this instanceof c&&(e.bindBufferBase(e.UNIFORM_BUFFER,2,this.geometry.SKIN),this.bones.some(e=>e.reflow))){const t=this.getJointMatrix(),r=new Float32Array(16*t.length);let n=0;for(const e of t)r.set(e.elements,0+16*n),n++;e.bufferSubData(e.UNIFORM_BUFFER,0,r)}this.material.UBO&&(e.bindBufferBase(e.UNIFORM_BUFFER,1,this.material.UBO),o&&(e.bufferSubData(e.UNIFORM_BUFFER,4*Float32Array.BYTES_PER_ELEMENT,new Float32Array([r.matrixWorld.elements[12],r.matrixWorld.elements[13],r.matrixWorld.elements[14]])),e.bufferSubData(e.UNIFORM_BUFFER,8*Float32Array.BYTES_PER_ELEMENT,new Float32Array([t.matrixWorld.elements[12],t.matrixWorld.elements[13],t.matrixWorld.elements[14]])))),e.uniform1i(e.getUniformLocation(this.program,"depthTexture"),l?i.index:s.index),this.material.pbrMetallicRoughness.baseColorTexture&&e.uniform1i(this.material.uniforms.baseColorTexture,this.material.pbrMetallicRoughness.baseColorTexture.count),this.material.pbrMetallicRoughness.metallicRoughnessTexture&&e.uniform1i(this.material.uniforms.metallicRoughnessTexture,this.material.pbrMetallicRoughness.metallicRoughnessTexture.count),this.material.normalTexture&&e.uniform1i(this.material.uniforms.normalTexture,this.material.normalTexture.count),this.material.occlusionTexture&&e.uniform1i(this.material.uniforms.occlusionTexture,this.material.occlusionTexture.count),this.material.emissiveTexture&&e.uniform1i(this.material.uniforms.emissiveTexture,this.material.emissiveTexture.count),this.material.doubleSided&&e.disable(e.CULL_FACE),this.geometry.indicesBuffer?e.drawElements(this.mode||e.TRIANGLES,this.geometry.indicesBuffer.length,4===this.geometry.indicesBuffer.BYTES_PER_ELEMENT?e.UNSIGNED_INT:e.UNSIGNED_SHORT,0):e.drawArrays(this.mode||e.TRIANGLES,0,this.geometry.attributes.POSITION.length/3),this.material.doubleSided&&e.enable(e.CULL_FACE)}calculateBounding(){const e=this.geometry.attributes.POSITION;let t=0;this.geometry.boundingSphere.center.add(this.geometry.boundingSphere.min).add(this.geometry.boundingSphere.max).scale(.5);for(let r=0;r<e.length;r+=3)t=Math.max(t,this.geometry.boundingSphere.center.distanceToSquared(e[r],e[r+1],e[r+2]));this.geometry.boundingSphere.radius=Math.sqrt(t)}setBoundingBox({min:e,max:t}){this.geometry.boundingSphere.min=new s(e),this.geometry.boundingSphere.max=new s(t),this.calculateBounding()}setIndicesBuffer(e){this.geometry.indicesBuffer=e}setAttributes(e){this.geometry.attributes=e}setTargets(e){this.geometry.targets=e}setProgram(e){this.program=e}setMode(e){this.mode=e}isVisible(e){const t=new s(this.geometry.boundingSphere.center.elements).applyMatrix4(this.matrixWorld),r=this.geometry.boundingSphere.radius*this.matrixWorld.getMaxScaleOnAxis();let n,i=!0;for(const s of e)if((n=s.elements[0]*t.elements[0]+s.elements[1]*t.elements[1]+s.elements[2]*t.elements[2]+s.elements[3])<-r){i=!1;break}return this.distance=n+r,i}}class c extends h{constructor(e,t){super(e,t)}setSkin(e){return this.skin=e,this}getJointMatrix(){const e=new n(this.matrixWorld).invert(),t=[];for(let r=0;r<this.boneInverses.length;r++){const s=(new n).multiply(e).multiply(this.bones[r].matrixWorld).multiply(this.boneInverses[r]);t.push(s)}return t}}class u extends l{}class m extends l{constructor(e,t){super(e,t),this.matrixWorldInvert=new n,this.projection=new n}setProps(e){this.props=e}setProjection(e){this.projection.set(e.elements)}setMatrixWorld(e){super.setMatrixWorld(e),this.matrixWorldInvert.setInverseOf(this.matrixWorld)}setZ(e){this.matrix.elements[14]=e,this.setMatrixWorld(this.matrix.elements)}getViewProjMatrix(){const e=new n;return e.multiply(this.projection),e.multiply(this.matrixWorldInvert),e}}class f{constructor(){this.opaqueChildren=[],this.transparentChildren=[],this.meshes=[],this.children=[],this.bin=[],this.matrixWorld=new n}}class d extends l{constructor(e,t){super(e,t),this.matrixWorldInvert=new n}setMatrixWorld(e){super.setMatrixWorld(e),this.matrixWorldInvert.setInverseOf(this.matrixWorld)}setZ(e){this.matrix.elements[14]=e,this.setMatrixWorld(this.matrix.elements)}update(e){const t=new n;t.makeRotationAxis(new s([0,1,0]),e),t.multiply(this.matrix),this.setMatrixWorld(t.elements)}}class p{constructor(e){const t=document.querySelector("#canvas");this.redraw=e,this.zoomValue=0,document.addEventListener("wheel",this),t.addEventListener("mousedown",this),t.addEventListener("mousemove",this),t.addEventListener("mouseup",this),document.addEventListener("keyup",this),document.addEventListener("keydown",this),addEventListener("resize",this)}handleEvent(e){switch(e.type){case"wheel":this.zoom(e);break;case"mousedown":this.onStart(e);break;case"mousemove":this.onMove(e);break;case"mouseup":this.onEnd();break;case"keyup":this.onKeyUp();break;case"keydown":this.onKeyDown(e);break;case"resize":this.onResize()}}onResize(){this.redraw("resize")}onKeyDown(e){(e.shiftKey||e.ctrlKey)&&(this.isPan=!0)}onKeyUp(){this.isPan=!1}onStart(e){this.x=e.clientX,this.y=e.clientY,this.isDrag=!0}onMove(e){this.isDrag&&(this.isPan?this.redraw("pan",[this.x,this.y],[e.clientX,e.clientY]):this.redraw("rotate",[this.x,this.y],[e.clientX,e.clientY]),this.x=e.clientX,this.y=e.clientY)}onEnd(){this.isDrag=!1}zoom(e){this.zoomValue=Math.min(this.zoomValue+e.deltaY,1250),this.redraw("zoom",Math.pow(1.001,this.zoomValue))}}const A={};let T,E=-1;function b(){return++E}function x(e,t){return Math.random()*(t-e)+e}function g(e,t,r){return e+r*(t-e)}function R(e){let t;switch(e){case"MAT2":t=4;break;case"MAT3":t=9;break;case"MAT4":t=16;break;case"VEC4":t=4;break;case"VEC3":t=3;break;case"VEC2":t=2;break;case"SCALAR":t=1}return t}function v(e){return"rotation"===e?4:"weights"===e?2:3}function F(e,t){if(0===t.length)return[-1,-1,0];let r=-1;for(let n=t.length-1;n>=0;n--)if(e>=t[n].time){r=n;break}if(-1===r||r===t.length-1)return r<0&&(r=0),[r,r,0];{const n=t[r],s=t[r+1];return e=Math.max(n.time,Math.min(e,s.time)),[r,r+1,function(e,t,r){return(r-e)/(t-e)}(n.time,s.time,e)]}}function P(e){let t;switch(A[e]){case"BYTE":case"UNSIGNED_BYTE":t=1;break;case"SHORT":case"UNSIGNED_SHORT":t=2;break;case"UNSIGNED_INT":case"FLOAT":t=4}return t}function w(e,t,r,n,s,i){const o=n,a=n/i;let l;switch(s&&s!==P(t)*a&&(n=s*i/P(t)-r/P(t)),A[t]){case"BYTE":l=new Int8Array(e,r,n);break;case"UNSIGNED_BYTE":l=new Uint8Array(e,r,n);break;case"SHORT":l=new Int16Array(e,r,n);break;case"UNSIGNED_SHORT":l=new Uint16Array(e,r,n);break;case"UNSIGNED_INT":l=new Uint32Array(e,r,n);break;case"FLOAT":l=new Float32Array(e,r,n)}if(s&&s!==P(t)*a){const e=new Float32Array(o);let r=0;for(let n=0;n<e.length;n+=a)e[n]=l[r],e[n+1]=l[r+1],e[n+2]=l[r+2],r+=a*(s/P(t)/a);return e}return l}function S(e,t,r){const n=T.createShader(e);T.shaderSource(n,t),T.compileShader(n),T.attachShader(r,n);const s=T.getShaderInfoLog(n);s&&console.error(s)}function y(e,t){!function e(r){t(r),r.children&&r.children.forEach(e)}(e)}function N(e){let t=e[0]*e[0]+e[1]*e[1];const r=.0016-t;return r>0?[e[0],e[1],Math.sqrt(r)]:(t=Math.sqrt(t),[.04*e[0]/t,.04*e[1]/t,0])}function M(e,t,r,o){const[a,l]=e,h=new n;h.setTranslate(new s([0,0,.05]));const c=new n(t);c.multiply(h);const u=c.multiplyVector4(new i([0,0,0,1]));u.elements[0]=(2*a/r-1)*u.elements[3],u.elements[1]=(-2*l/o+1)*u.elements[3];const m=c.invert().multiplyVector4(u);return[m.elements[0],m.elements[1]]}function B(e){const{aspect:t,zoom:r}=e;let s;if("perspective"===e.type&&e.perspective){const{yfov:i}=e.perspective,o=i*t;s=(new n).setPerspective(o*r*(180/Math.PI),t,e.perspective.znear||1,e.perspective.zfar||2e6)}else"orthographic"===e.type&&e.orthographic&&(s=(new n).setOrtho(e.orthographic.xmag*r,e.orthographic.ymag*r,e.orthographic.znear,e.orthographic.zfar));return s}function U(e=0,t=0){return e+t}function D(e){let t;switch(e){case"POSITION":t=[0,3,T.FLOAT];break;case"NORMAL":t=[1,3,T.FLOAT];break;case"TEXCOORD_0":t=[2,2,T.FLOAT];break;case"JOINTS_0":t=[3,4,T.UNSIGNED_SHORT];break;case"WEIGHTS_0":t=[4,4,T.FLOAT];break;case"TANGENT":t=[5,4,T.FLOAT];break;case"COLOR_0":t=[6,4,T.FLOAT]}return t}var L=r(2),O=r.n(L),W=r(3),j=r.n(W),k=r(4),X=r.n(k);let I;class V{constructor(){this.envMatrix=new n}setCamera(e){this._camera=e}setGl(e){I=e}createEnvironment(){I.useProgram(this.program),I.bindVertexArray(this.VAO);const e=new n,t=Object.assign({},this._camera.props,{perspective:{yfov:.6,znear:.01,zfar:1e4}});e.multiply(B(t)),e.multiply(this._camera.matrixWorldInvert),e.multiply(this.envMatrix),I.uniform1f(this.level,3),I.uniform1i(this.diffuse,this.texture.count),I.uniformMatrix4fv(this.MVPMatrix,!1,e.elements),I.drawElements(I.TRIANGLES,this.IndexBufferLength,I.UNSIGNED_SHORT,0),I.bindVertexArray(null)}createEnvironmentBuffer(){const e=10*this._camera.modelSize,t=[],r=[],n=[];for(let s=0;s<=10;s++){const i=s*Math.PI/10,o=Math.sin(i),a=Math.cos(i);for(let i=0;i<=10;i++){const l=2*i*Math.PI/10,h=Math.sin(l),c=Math.cos(l)*o,u=a,m=h*o,f=1-i/10,d=1-s/10;r.push(c),r.push(u),r.push(m),n.push(f),n.push(d),t.push(e*c),t.push(e*u),t.push(e*m)}}const s=[];for(let e=0;e<10;e++)for(let t=0;t<10;t++){const r=11*e+t,n=r+10+1;s.push(r),s.push(n),s.push(r+1),s.push(n),s.push(n+1),s.push(r+1)}this.VAO=I.createVertexArray(),I.bindVertexArray(this.VAO);{const e=I.createBuffer();I.bindBuffer(I.ARRAY_BUFFER,e),I.bufferData(I.ARRAY_BUFFER,new Float32Array(t),I.STATIC_DRAW),I.enableVertexAttribArray(0),I.vertexAttribPointer(0,3,I.FLOAT,!1,0,0)}{const e=I.createBuffer();I.bindBuffer(I.ARRAY_BUFFER,e),I.bufferData(I.ARRAY_BUFFER,new Float32Array(n),I.STATIC_DRAW),I.enableVertexAttribArray(1),I.vertexAttribPointer(1,2,I.FLOAT,!1,0,0)}{const e=I.createBuffer();I.bindBuffer(I.ELEMENT_ARRAY_BUFFER,e),I.bufferData(I.ELEMENT_ARRAY_BUFFER,new Uint16Array(s),I.STATIC_DRAW),this.IndexBufferLength=s.length}return I.bindVertexArray(null),this.program=I.createProgram(),S(I.VERTEX_SHADER,j.a,this.program),S(I.FRAGMENT_SHADER,X.a,this.program),I.linkProgram(this.program),this.level=I.getUniformLocation(this.program,"level"),this.diffuse=I.getUniformLocation(this.program,"diffuse"),this.MVPMatrix=I.getUniformLocation(this.program,"MVPMatrix"),new Promise((e,t)=>{const r=b();this.texture={data:I.createTexture(),count:r};const n=new Image;n.crossOrigin="anonymous",n.onload=(()=>{I.activeTexture(I[`TEXTURE${this.texture.count}`]),I.bindTexture(I.TEXTURE_2D,this.texture.data),I.pixelStorei(I.UNPACK_FLIP_Y_WEBGL,!0),I.texImage2D(I.TEXTURE_2D,0,I.RGBA,I.RGBA,I.UNSIGNED_BYTE,n),I.texParameteri(I.TEXTURE_2D,I.TEXTURE_MAG_FILTER,I.LINEAR),I.texParameteri(I.TEXTURE_2D,I.TEXTURE_MIN_FILTER,I.LINEAR_MIPMAP_NEAREST),I.generateMipmap(I.TEXTURE_2D),e()}),n.onerror=(e=>{t(e)}),n.src=O.a})}}class C{constructor(){this.counterEl=document.createElement("div"),this.counterEl.setAttribute("style","position: absolute; top: 0; right: 0; color: #fff; font-size: 30px; background: #000;"),document.body.appendChild(this.counterEl),this.fps=0,this.elapsedTime=0,this.lastTime=0}tick(e){this.fps++,this.elapsedTime+=e-this.lastTime,this.lastTime=e,this.elapsedTime>=1e3&&(this.counterEl.innerHTML=String(this.fps),this.fps=0,this.elapsedTime-=1e3)}}var z=r(5),G=r.n(z),H=r(6),J=r.n(H);let Y;class K{constructor(e){this.url=e,this.host=e.substr(0,e.lastIndexOf("/")+1),this.tracks=[],this.skins=[],this.textures=null,this.samplers=null,this.arrayBuffer=null,this.cameras=[],this.programs={}}setScene(e){this.scene=e}setGl(e){Y=e}setCamera(e){this._camera=e}setLight(e){this.light=e}setCanvas(e){this.canvas=e}setResize(e){this.resize=e}setUpdateCamera(e){this.updateCamera=e}setDefines(e){this.defines=e}getBuffer(){return Promise.all(this.scene.bin.map(e=>fetch(`${this.host}${e}`).then(e=>e.arrayBuffer()))).then(e=>{this.arrayBuffer=e})}compileShader(e,t){const r=Y.createProgram();return S(Y.VERTEX_SHADER,e,r),S(Y.FRAGMENT_SHADER,t,r),Y.linkProgram(r),r}buildPrim(e,t,r,n,i){const a=this.json.accessors[i.indices],l=new Map;for(const e in i.attributes)l.set(e,this.json.accessors[i.attributes[e]]);const u=[];if(i.targets)for(const e of i.targets){const t={};for(const r in e){t[r]=this.json.accessors[e[r]];const n=t[r],s=this.json.bufferViews[n.bufferView];t[r]=w(this.arrayBuffer[s.buffer],n.componentType,U(s.byteOffset,n.byteOffset),R(n.type)*n.count)}u.push(t)}const m=void 0!==i.material?JSON.parse(JSON.stringify(this.json.materials[i.material])):{pbrMetallicRoughness:{baseColorFactor:[.8,.8,.8,1]}},f=[...this.defines];let d,p;if(m.pbrMetallicRoughness.metallicRoughnessTexture&&(m.pbrMetallicRoughness.metallicRoughnessTexture=Object.assign({},this.textures[m.pbrMetallicRoughness.metallicRoughnessTexture.index]),f.push({name:"USE_PBR"}),f.push({name:"METALROUGHNESSMAP"})),m.normalTexture&&(m.normalTexture=Object.assign({},this.textures[m.normalTexture.index]),f.push({name:"NORMALMAP"})),m.occlusionTexture&&(m.occlusionTexture=Object.assign({},this.textures[m.occlusionTexture.index]),f.push({name:"OCCLUSIONMAP"})),m.pbrMetallicRoughness.baseColorTexture&&(m.pbrMetallicRoughness.baseColorTexture=Object.assign({},this.textures[m.pbrMetallicRoughness.baseColorTexture.index]),f.push({name:"BASECOLORTEXTURE"})),m.emissiveTexture&&(m.emissiveTexture=Object.assign({},this.textures[m.emissiveTexture.index]),f.push({name:"EMISSIVEMAP"})),void 0!==r&&f.push({name:"JOINTNUMBER",value:this.skins[r].jointNames.length}),(i.attributes.TANGENT||m.normalTexture)&&f.push({name:"TANGENT"}),this.programs[f.map(e=>e.name).join("")])d=this.programs[f.map(e=>e.name).join("")];else{const e=f.map(e=>`#define ${e.name} ${e.value||1}`+"\n").join("");d=this.compileShader(G.a.replace(/\n/,`\n${e}`),J.a.replace(/\n/,`\n${e}`)),this.programs[f.map(e=>e.name).join("")]=d}if(a){const e=this.json.bufferViews[a.bufferView];p=w(this.arrayBuffer[e.buffer],a.componentType,U(e.byteOffset,a.byteOffset),R(a.type)*a.count)}const A={min:l.get("POSITION").min,max:l.get("POSITION").max},T={};for(const e of l.keys()){const t=l.get(e),r=this.json.bufferViews[t.bufferView];if(T[e]=w(this.arrayBuffer[r.buffer],t.componentType,U(r.byteOffset,t.byteOffset),R(t.type)*t.count,r.byteStride,t.count),i.targets&&e in i.targets[0]){let t=0;const r=T[e];T[e]=new Float32Array(r.length);for(let s=0;s<T[e].length;s++)"TANGENT"!==e||(s+1)%4!=0?T[e][s]=r[s]+n[0]*u[0][e][s-t]+n[1]*u[1][e][s-t]:t++}}m.normalTexture&&void 0===i.attributes.TANGENT&&(T.TANGENT=function(e,t,r,n){const i=new Float32Array(r.length/3*4);for(let r=0;r<e.length;r+=3){const o=[e[r],e[r+1],e[r+2]],h=o.map(e=>a(t,e)),c=o.map(e=>a(n,e,2)),u=h[1].subtract(h[0]),m=h[2].subtract(h[0]),f=c[1].subtract(c[0]),d=c[2].subtract(c[0]);let p=f.elements[0]*d.elements[1]-f.elements[1]*d.elements[0];p=0!==p?1/p:1;const A=new s([(d.elements[1]*u.elements[0]-f.elements[1]*m.elements[0])*p,(d.elements[1]*u.elements[1]-f.elements[1]*m.elements[1])*p,(d.elements[1]*u.elements[2]-f.elements[1]*m.elements[2])*p]);A.normalize(),o.forEach(e=>{l(i,e,A)})}return i;function a(e,t,r=3){return t*=r,3===r?new s([e[t],e[t+1],e[t+2]]):2===r?new o([e[t],e[t+1]]):void 0}function l(e,t,r,n=4,s=((e,t)=>e+t)){t*=n;for(let i=0;i<n;++i)e[t+i]=3===i?-1:s(e[t+i],r.elements[i])}}(p,T.POSITION,T.NORMAL,T.TEXCOORD_0));const E=void 0!==r?new c(t,e).setSkin(r):new h(t,e);E.setProgram(d),E.setMode(i.mode),E.setMaterial(m),E.setAttributes(T),E.setIndicesBuffer(p),E.setBoundingBox(A),E.setTargets(u),E.updateMatrix();const b=Y.createVertexArray();Y.bindVertexArray(b);for(const e in T){const t=Y.createBuffer();Y.bindBuffer(Y.ARRAY_BUFFER,t),Y.bufferData(Y.ARRAY_BUFFER,T[e],Y.STATIC_DRAW);const r=D(e);Y.enableVertexAttribArray(r[0]),Y.vertexAttribPointer(r[0],r[1],r[2],!1,0,0)}if(p){const e=Y.createBuffer();Y.bindBuffer(Y.ELEMENT_ARRAY_BUFFER,e),Y.bufferData(Y.ELEMENT_ARRAY_BUFFER,p,Y.STATIC_DRAW)}return E.geometry.VAO=b,Y.bindVertexArray(null),m.pbrMetallicRoughness.baseColorTexture&&(E.material.uniforms.baseColorTexture=Y.getUniformLocation(E.program,"baseColorTexture")),m.pbrMetallicRoughness.metallicRoughnessTexture&&(E.material.uniforms.metallicRoughnessTexture=Y.getUniformLocation(E.program,"metallicRoughnessTexture")),m.normalTexture&&(E.material.uniforms.normalTexture=Y.getUniformLocation(E.program,"normalTexture")),m.occlusionTexture&&(E.material.uniforms.occlusionTexture=Y.getUniformLocation(E.program,"occlusionTexture")),m.emissiveTexture&&(E.material.uniforms.emissiveTexture=Y.getUniformLocation(E.program,"emissiveTexture")),E}walkByMesh(e,t){const r=this.json.nodes[t];let n;if(void 0!==r.camera){(n=new m(t,e)).setProps(Object.assign({zoom:1,aspect:this.canvas.offsetWidth/this.canvas.offsetHeight},this.json.cameras[r.camera]));const s=B(n.props);n.setProjection(s),this._camera=n,this.updateCamera(this._camera),this.cameras.push(n)}else n=void 0!==r.isBone?new u(t,e):new l(t,e);if(r.translation||r.rotation||r.scale?n.setPosition(r.translation,r.rotation,r.scale):r.matrix&&n.setMatrix(r.matrix),n.updateMatrix(),e.children.push(n),e=n,void 0!==r.mesh){if(void 0!==r.skin)for(const e of this.skins[r.skin].jointNames)y(this.scene,this.buildBones.bind(this,e,this.skins[r.skin]));e.children.push(...this.json.meshes[r.mesh].primitives.map(this.buildPrim.bind(this,e,this.json.meshes[r.mesh].name,r.skin,this.json.meshes[r.mesh].weights)))}r.children&&r.children.length&&r.children.forEach(this.walkByMesh.bind(this,e))}calculateFov(){let e;y(this.scene,t=>{t instanceof h&&(e||(e=t),t.geometry.boundingSphere.radius>e.geometry.boundingSphere.radius&&(e=t))});const t=Math.max(e.matrixWorld.getScaleZ(),1),r=Math.hypot(e.matrixWorld.elements[12],e.matrixWorld.elements[13],e.matrixWorld.elements[14]);this._camera.modelSize=e.geometry.boundingSphere.radius*t+r+Math.hypot(...e.geometry.boundingSphere.center.elements),this.resize()}buildMesh(){this.json.scenes[void 0!==this.json.scene?this.json.scene:0].nodes.forEach(e=>{this.json.nodes[e].children&&this.json.nodes[e].children.length&&this.walkByMesh(this.scene,e),void 0!==this.json.nodes[e].mesh&&this.walkByMesh(this.scene,e),void 0!==this.json.nodes[e].camera&&this.walkByMesh(this.scene,e)}),this.calculateFov();const e=a(this._camera.getViewProjMatrix());return y(this.scene,t=>{if(t instanceof c){t.bones=this.skins[t.skin].bones,t.boneInverses=this.skins[t.skin].boneInverses;const e=t.getJointMatrix(),r=new Float32Array(16*e.length);let n=0;for(const t of e)r.set(t.elements,0+16*n),n++;const s=Y.getUniformBlockIndex(t.program,"Skin");Y.uniformBlockBinding(t.program,s,2);const i=Y.createBuffer();Y.bindBuffer(Y.UNIFORM_BUFFER,i),Y.bufferData(Y.UNIFORM_BUFFER,r,Y.DYNAMIC_DRAW),t.geometry.SKIN=i,Y.bindBuffer(Y.UNIFORM_BUFFER,null)}if(t instanceof h){const r=new Float32Array(12);r.set(t.material.pbrMetallicRoughness.baseColorFactor||[.8,.8,.8,1]),r.set([this.light.matrixWorld.elements[12],this.light.matrixWorld.elements[13],this.light.matrixWorld.elements[14]],4),r.set([this._camera.matrixWorld.elements[12],this._camera.matrixWorld.elements[13],this._camera.matrixWorld.elements[14]],8);const s=Y.getUniformBlockIndex(t.program,"Material");Y.uniformBlockBinding(t.program,s,1);const i=Y.createBuffer();Y.bindBuffer(Y.UNIFORM_BUFFER,i),Y.bufferData(Y.UNIFORM_BUFFER,r,Y.STATIC_DRAW),t.material.UBO=i;const o=new n(t.matrixWorld);o.invert().transpose();const a=new Float32Array(81);a.set(t.matrixWorld.elements,0),a.set(o.elements,16),a.set(this._camera.matrixWorldInvert.elements,32),a.set(this._camera.projection.elements,48),a.set(this.light.matrixWorldInvert.elements,64),a.set(new Float32Array([0]),80);const l=Y.getUniformBlockIndex(t.program,"Matrices");Y.uniformBlockBinding(t.program,l,0);const h=Y.createBuffer();Y.bindBuffer(Y.UNIFORM_BUFFER,h),Y.bufferData(Y.UNIFORM_BUFFER,a,Y.DYNAMIC_DRAW),t.geometry.UBO=h,Y.bindBuffer(Y.UNIFORM_BUFFER,null),t.material.alphaMode?this.scene.transparentChildren.push(t):this.scene.opaqueChildren.push(t),this.scene.meshes.push(t),t.visible=t.isVisible(e)}}),this.scene.opaqueChildren.sort((e,t)=>e.distance-t.distance),this.scene.transparentChildren.sort((e,t)=>t.distance-e.distance),!0}buildAnimation(){if(!this.json.animations)return!0;for(const e of this.json.animations)for(const t of e.channels){const r=e.samplers[t.sampler];if(r){const{target:n}=t,s=n.node,i=void 0!==e.parameters?e.parameters[r.input]:r.input,o=void 0!==e.parameters?e.parameters[r.output]:r.output,a=this.json.accessors[i],h=this.json.accessors[o],c=this.json.bufferViews[a.bufferView],u=this.json.bufferViews[h.bufferView],m=w(this.arrayBuffer[c.buffer],a.componentType,U(c.byteOffset,a.byteOffset),R(a.type)*a.count),f=w(this.arrayBuffer[u.buffer],h.componentType,U(u.byteOffset,h.byteOffset),R(h.type)*h.count),d=v(n.path),p=[];for(let e=0;e<m.length;e++){const t=m[e],r=f.slice(e*d,(e+1)*d);p.push({time:t,value:r})}const A=[];y(this.scene,e=>{e.name===s&&("weights"===n.path&&e instanceof l&&(e=e.children[0]),A.push(e))}),A.length&&this.tracks.push({stoped:!1,meshes:A,type:n.path,name:`${A[0].name}.${n.path}`,keys:p,interpolation:r.interpolation})}}return!0}buildSkin(){if(!this.json.skins)return!0;for(const e of this.json.skins){const t=this.json.accessors[e.inverseBindMatrices],r=this.json.bufferViews[t.bufferView],s=w(this.arrayBuffer[r.buffer],t.componentType,U(r.byteOffset,t.byteOffset),R(t.type)*t.count),i={jointNames:e.joints,inverseBindMatrices:s,bones:[],boneInverses:[]};let o=0;for(const e of i.jointNames){this.json.nodes[e].isBone=!0;const t=i.inverseBindMatrices,r=(new n).set(t.slice(16*o,16*(o+1)));i.boneInverses.push(r),o++}this.skins.push(i)}return!0}buildBones(e,t,r){r.name===e&&t.bones.push(r)}getJson(){return fetch(this.url).then(e=>e.json()).then(e=>{for(const t in e.buffers)this.scene.bin.push(e.buffers[t].uri);return this.json=e,!0})}initTextures(){if(!this.json.textures)return!0;const e=this.json.samplers||[{}];this.samplers=e.map(e=>{const t=Y.createSampler();return Y.samplerParameteri(t,Y.TEXTURE_MIN_FILTER,e.minFilter||9986),Y.samplerParameteri(t,Y.TEXTURE_MAG_FILTER,e.magFilter||9729),Y.samplerParameteri(t,Y.TEXTURE_WRAP_S,e.wrapS||10497),Y.samplerParameteri(t,Y.TEXTURE_WRAP_T,e.wrapT||10497),t});const t={};this.json.textures.forEach(e=>{const r=String(e.sampler)+String(e.source);t[r]=e,t[r].name=r,e.name=r});const r=Object.values(t).map(e=>new Promise((t,r)=>{const n=this.samplers[void 0!==e.sampler?e.sampler:0],s=this.json.images[e.source],i=new Image;i.onload=(()=>{t(this.handleTextureLoaded(n,i,e.name))}),i.onerror=(e=>{r(e)}),i.crossOrigin="anonymous",i.src=`${this.host}${s.uri}`}));return Promise.all(r).then(e=>(this.textures=this.json.textures.map(t=>e.find(e=>e.name===t.name)),!0))}handleTextureLoaded(e,t,r){const n=b(),s={image:t.src.substr(t.src.lastIndexOf("/")),data:Y.createTexture(),count:n,name:r};return Y.activeTexture(Y[`TEXTURE${n}`]),Y.bindTexture(Y.TEXTURE_2D,s.data),Y.bindSampler(n,e),Y.texImage2D(Y.TEXTURE_2D,0,Y.RGBA,Y.RGBA,Y.UNSIGNED_BYTE,t),Y.generateMipmap(Y.TEXTURE_2D),s}}class Z{setCanvas(e){this.canvas=e}setCamera(e){this.camera=e}setLight(e){this.light=e}get width(){return this.canvas.offsetWidth*devicePixelRatio}get height(){return this.canvas.offsetHeight*devicePixelRatio}}var q=r(0),Q=r.n(q),_=r(7),$=r.n(_),ee=r(1),te=r.n(ee);let re;const ne=4,se=32;var ie=r(8),oe=r.n(ie);let ae,le;var he=r(9),ce=r.n(he),ue=r(10),me=r.n(ue);let fe;class de extends Z{constructor(){super(),this.scale=2}setGL(e){fe=e}preProcessing(e){fe.clear(fe.COLOR_BUFFER_BIT|fe.DEPTH_BUFFER_BIT),e.renderScene(!0,!0),fe.bindFramebuffer(fe.FRAMEBUFFER,this.framebuffer),fe.framebufferTexture2D(fe.FRAMEBUFFER,fe.COLOR_ATTACHMENT0,fe.TEXTURE_2D,this.texture,0),fe.useProgram(this.program),fe.viewport(0,0,this.width/this.scale,this.height/this.scale),fe.bindVertexArray(this.quadVAO);const t=B(Object.assign({},this.camera.props,{zoom:1}));fe.uniformMatrix4fv(fe.getUniformLocation(this.program,"Iproj"),!1,(new n).setInverseOf(t).elements),fe.uniformMatrix4fv(fe.getUniformLocation(this.program,"proj"),!1,t.elements),fe.uniformMatrix4fv(fe.getUniformLocation(this.program,"Iview"),!1,this.camera.matrixWorld.elements),fe.uniformMatrix4fv(fe.getUniformLocation(this.program,"light"),!1,this.light.matrixWorldInvert.elements),fe.uniform1i(fe.getUniformLocation(this.program,"lightTexture"),e.preDepthTexture.index),fe.uniform1i(fe.getUniformLocation(this.program,"cameraTexture"),e.depthTexture.index),fe.drawArrays(fe.TRIANGLES,0,6),fe.bindFramebuffer(fe.FRAMEBUFFER,null),fe.viewport(0,0,this.width,this.height)}buildScreenBuffer(e){this.framebuffer=fe.createFramebuffer(),fe.bindFramebuffer(fe.FRAMEBUFFER,this.framebuffer),this.texture=e.createOneChannelTexture(this.scale),fe.framebufferTexture2D(fe.FRAMEBUFFER,fe.COLOR_ATTACHMENT0,fe.TEXTURE_2D,this.texture,0),this.program=fe.createProgram(),S(fe.VERTEX_SHADER,me.a,this.program),S(fe.FRAGMENT_SHADER,ce.a,this.program),fe.linkProgram(this.program);this.quadVAO=fe.createVertexArray(),fe.bindVertexArray(this.quadVAO);const t=fe.createBuffer();return fe.bindBuffer(fe.ARRAY_BUFFER,t),fe.bufferData(fe.ARRAY_BUFFER,new Float32Array([1,1,-1,1,-1,-1,-1,-1,1,-1,1,1]),fe.STATIC_DRAW),fe.enableVertexAttribArray(0),fe.vertexAttribPointer(0,2,fe.FLOAT,!1,0,0),fe.bindVertexArray(null),fe.bindFramebuffer(fe.FRAMEBUFFER,null),{name:"LIGHT"}}attachUniform(e){fe.uniform1i(fe.getUniformLocation(e,"light"),this.texture.index)}postProcessing(){}}var pe=r(11),Ae=r.n(pe);let Te;const Ee={bloom:class extends Z{setGL(e){ae=e}attachUniform(e){ae.uniform1i(ae.getUniformLocation(e,"bloom"),this.blurTexture.index)}postProcessing(e){ae.bindFramebuffer(ae.FRAMEBUFFER,this.framebuffer),ae.useProgram(this.bloorProgram),ae.framebufferTexture2D(ae.FRAMEBUFFER,ae.COLOR_ATTACHMENT0,ae.TEXTURE_2D,this.hdrTexture,0),ae.uniform1i(ae.getUniformLocation(this.bloorProgram,"diff"),e.screenTexture.index),ae.drawArrays(ae.TRIANGLES,0,6),ae.useProgram(this.program),ae.viewport(0,0,this.width/2,this.height/2),this.renderBlur(this.hdrTexture,this.program),this.renderBlur(this.blurTexture,this.program),this.renderBlur(this.blurTexture,this.program),this.renderBlur(this.blurTexture,this.program),this.renderBlur(this.blurTexture,this.program),ae.bindFramebuffer(ae.FRAMEBUFFER,null),ae.viewport(0,0,this.width,this.height)}buildScreenBuffer(e){return this.framebuffer=ae.createFramebuffer(),ae.bindFramebuffer(ae.FRAMEBUFFER,this.framebuffer),this.tempBlurTexture=e.createDefaultTexture(2),this.blurTexture=e.createDefaultTexture(2),this.hdrTexture=e.createByteTexture(),ae.bindFramebuffer(ae.FRAMEBUFFER,null),this.program=ae.createProgram(),S(ae.VERTEX_SHADER,Q.a,this.program),S(ae.FRAGMENT_SHADER,te.a,this.program),ae.linkProgram(this.program),this.bloorProgram=ae.createProgram(),S(ae.VERTEX_SHADER,Q.a,this.bloorProgram),S(ae.FRAGMENT_SHADER,oe.a,this.bloorProgram),ae.linkProgram(this.bloorProgram),{name:"BLOOM"}}renderBlur(e,t){ae.framebufferTexture2D(ae.FRAMEBUFFER,ae.COLOR_ATTACHMENT0,ae.TEXTURE_2D,this.tempBlurTexture,0),ae.clearColor(1,1,1,0),ae.clear(ae.COLOR_BUFFER_BIT|ae.DEPTH_BUFFER_BIT|ae.STENSIL_BUFFER_BIT),ae.uniform1i(ae.getUniformLocation(t,"uTexture"),e.index),ae.uniform2f(ae.getUniformLocation(t,"denom"),1,0),ae.drawArrays(ae.TRIANGLES,0,6),ae.framebufferTexture2D(ae.FRAMEBUFFER,ae.COLOR_ATTACHMENT0,ae.TEXTURE_2D,this.blurTexture,0),ae.uniform1i(ae.getUniformLocation(t,"uTexture"),this.tempBlurTexture.index),ae.uniform2f(ae.getUniformLocation(t,"denom"),0,1),ae.drawArrays(ae.TRIANGLES,0,6)}preProcessing(){}},ssao:class extends Z{constructor(){super(),this.scale=2}setGL(e){re=e}attachUniform(e){re.uniform1i(re.getUniformLocation(e,"ssao"),this.ssaoTexture.index)}postProcessing(e){re.bindFramebuffer(re.FRAMEBUFFER,this.framebuffer),re.framebufferTexture2D(re.FRAMEBUFFER,re.COLOR_ATTACHMENT0,re.TEXTURE_2D,this.ssaoTexture,0),re.clearColor(1,1,1,0),re.clear(re.COLOR_BUFFER_BIT|re.DEPTH_BUFFER_BIT),re.useProgram(this.ssaoProgram);const t=this.camera.props.perspective||this.camera.props.orthographic;re.uniform1i(re.getUniformLocation(this.ssaoProgram,"normBuff"),e.normalTexture.index),re.uniform1i(re.getUniformLocation(this.ssaoProgram,"depthBuff"),e.depthTexture.index),re.uniform1i(re.getUniformLocation(this.ssaoProgram,"noice"),this.noice.index),re.uniform2f(re.getUniformLocation(this.ssaoProgram,"noiseScale"),this.width/ne,this.height/ne),re.uniform1f(re.getUniformLocation(this.ssaoProgram,"zFar"),t.zfar),re.uniform1f(re.getUniformLocation(this.ssaoProgram,"zNear"),t.znear),re.uniformMatrix4fv(re.getUniformLocation(this.ssaoProgram,"proj"),!1,this.camera.projection.elements),re.uniformMatrix4fv(re.getUniformLocation(this.ssaoProgram,"projI"),!1,(new n).setInverseOf(this.camera.projection).elements),re.uniform3fv(re.getUniformLocation(this.ssaoProgram,"kernels"),this.kernels),re.viewport(0,0,this.width/this.scale,this.height/this.scale),re.drawArrays(re.TRIANGLES,0,6),re.framebufferTexture2D(re.FRAMEBUFFER,re.COLOR_ATTACHMENT0,re.TEXTURE_2D,this.ssaoBlurTexture,0),re.clear(re.COLOR_BUFFER_BIT|re.DEPTH_BUFFER_BIT),re.useProgram(this.ssaoBlurProgram),re.uniform1i(re.getUniformLocation(this.ssaoBlurProgram,"uTexture"),this.ssaoTexture.index),re.uniform2f(re.getUniformLocation(this.ssaoBlurProgram,"denom"),1,0),re.drawArrays(re.TRIANGLES,0,6),re.framebufferTexture2D(re.FRAMEBUFFER,re.COLOR_ATTACHMENT0,re.TEXTURE_2D,this.ssaoTexture,0),re.uniform1i(re.getUniformLocation(this.ssaoBlurProgram,"uTexture"),this.ssaoBlurTexture.index),re.uniform2f(re.getUniformLocation(this.ssaoBlurProgram,"denom"),0,1),re.drawArrays(re.TRIANGLES,0,6),re.bindFramebuffer(re.FRAMEBUFFER,null),re.viewport(0,0,this.width,this.height)}buildScreenBuffer(e){return this.framebuffer=re.createFramebuffer(),re.bindFramebuffer(re.FRAMEBUFFER,this.framebuffer),this.ssaoTexture=e.createOneChannelTexture(this.scale),this.ssaoBlurTexture=e.createOneChannelTexture(this.scale),re.framebufferTexture2D(re.FRAMEBUFFER,re.COLOR_ATTACHMENT0,re.TEXTURE_2D,this.ssaoTexture,0),this.ssaoProgram=re.createProgram(),S(re.VERTEX_SHADER,Q.a,this.ssaoProgram),S(re.FRAGMENT_SHADER,$.a,this.ssaoProgram),re.linkProgram(this.ssaoProgram),this.ssaoBlurProgram=re.createProgram(),S(re.VERTEX_SHADER,Q.a,this.ssaoBlurProgram),S(re.FRAGMENT_SHADER,te.a,this.ssaoBlurProgram),re.linkProgram(this.ssaoBlurProgram),this.buildNoice(e),this.buildKernels(),re.bindFramebuffer(re.FRAMEBUFFER,null),{name:"SSAO"}}buildNoice(e){const t=new Float32Array(ne*ne*3);for(let e=0;e<ne*ne;e++){const r=new s([2*x(0,1)-1,2*x(0,1)-1,.1]);t[3*e]=r.elements[0],t[3*e+1]=r.elements[1],t[3*e+2]=r.elements[2]}this.noice=e.createNoiceTexture(ne,t)}buildKernels(){const e=new Array(se);for(let t=0;t<e.length;t++){e[t]=new s([2*x(0,1)-1,2*x(0,1)-1,x(0,1)]),e[t].normalize(),e[t].scale(x(0,1));let r=t/e.length;r=g(.1,1,r*r),e[t].scale(r)}this.kernels=new Float32Array(3*e.length);let t=0;for(const r of e)this.kernels.set(r.elements,3*t),t++}preProcessing(){}},shadow:class extends Z{setGL(e){le=e}preProcessing(e){le.clear(le.COLOR_BUFFER_BIT|le.DEPTH_BUFFER_BIT),e.renderScene(!0,!0)}buildScreenBuffer(){return{name:"SHADOW"}}attachUniform(){}postProcessing(){}},light:de};class be{constructor(e){this.postprocessors=e.map(e=>new Ee[e]),this.MSAA=4}setRender(e){this.renderScene=e}setCamera(e){this.camera=e,this.postprocessors.forEach(t=>{t.setCamera(e)})}setLight(e){this.postprocessors.forEach(t=>{t.light=e})}setGl(e){Te=e,this.postprocessors.forEach(e=>{e.setGL(Te)}),this.fakeDepth=this.createNoiceTexture(1,new Float32Array([1,1,0]))}setCanvas(e){this.canvas=e,this.postprocessors.forEach(t=>{t.setCanvas(e)})}get width(){return this.canvas.offsetWidth*devicePixelRatio}get height(){return this.canvas.offsetHeight*devicePixelRatio}bindPrePass(){Te.bindFramebuffer(Te.FRAMEBUFFER,this.preframebuffer)}bindPostPass(){Te.bindFramebuffer(Te.FRAMEBUFFER,this.renderframebuffer)}preProcessing(){this.postprocessors.forEach(e=>e.preProcessing(this))}postProcessing(){Te.bindFramebuffer(Te.READ_FRAMEBUFFER,this.renderframebuffer),Te.bindFramebuffer(Te.DRAW_FRAMEBUFFER,this.framebuffer),Te.readBuffer(Te.COLOR_ATTACHMENT0),Te.drawBuffers([Te.COLOR_ATTACHMENT0]),Te.blitFramebuffer(0,0,this.width,this.height,0,0,this.width,this.height,Te.COLOR_BUFFER_BIT,Te.NEAREST),Te.readBuffer(Te.COLOR_ATTACHMENT1),Te.drawBuffers([Te.NONE,Te.COLOR_ATTACHMENT1]),Te.blitFramebuffer(0,0,this.width,this.height,0,0,this.width,this.height,Te.COLOR_BUFFER_BIT,Te.NEAREST),Te.blitFramebuffer(0,0,this.width,this.height,0,0,this.width,this.height,Te.DEPTH_BUFFER_BIT,Te.NEAREST),Te.bindVertexArray(this.VAO),this.postprocessors.forEach(e=>e.postProcessing(this)),Te.bindFramebuffer(Te.FRAMEBUFFER,null),Te.useProgram(this.program),this.postprocessors.forEach(e=>{e.attachUniform(this.program)}),Te.uniform1i(Te.getUniformLocation(this.program,"original"),this.screenTexture.index),Te.uniform1i(Te.getUniformLocation(this.program,"normal"),this.normalTexture.index),Te.uniform1i(Te.getUniformLocation(this.program,"depth"),this.depthTexture.index),Te.uniform1i(Te.getUniformLocation(this.program,"preDepth"),this.preDepthTexture.index),Te.drawArrays(Te.TRIANGLES,0,6)}createTexture(){const e=b(),t=Te.createTexture();return Te.activeTexture(Te[`TEXTURE${e}`]),Te.bindTexture(Te.TEXTURE_2D,t),t.index=e,t}createByteTexture(){const e=this.createTexture();return Te.texParameteri(Te.TEXTURE_2D,Te.TEXTURE_MAG_FILTER,Te.NEAREST),Te.texParameteri(Te.TEXTURE_2D,Te.TEXTURE_MIN_FILTER,Te.NEAREST),Te.texImage2D(Te.TEXTURE_2D,0,Te.RGBA,this.width,this.height,0,Te.RGBA,Te.UNSIGNED_BYTE,null),e}createDefaultTexture(e=1){const t=this.createTexture();return Te.texParameteri(Te.TEXTURE_2D,Te.TEXTURE_MAG_FILTER,Te.NEAREST),Te.texParameteri(Te.TEXTURE_2D,Te.TEXTURE_MIN_FILTER,Te.NEAREST),Te.texImage2D(Te.TEXTURE_2D,0,Te.RGBA16F,this.width/e,this.height/e,0,Te.RGBA,Te.FLOAT,null),t}createOneChannelTexture(e=1){const t=this.createTexture();return Te.texParameteri(Te.TEXTURE_2D,Te.TEXTURE_MAG_FILTER,Te.LINEAR),Te.texParameteri(Te.TEXTURE_2D,Te.TEXTURE_MIN_FILTER,Te.LINEAR),Te.texImage2D(Te.TEXTURE_2D,0,Te.R8,this.width/e,this.height/e,0,Te.RED,Te.UNSIGNED_BYTE,null),t}createDepthTexture(){const e=this.createTexture();return Te.texParameteri(Te.TEXTURE_2D,Te.TEXTURE_MAG_FILTER,Te.NEAREST),Te.texParameteri(Te.TEXTURE_2D,Te.TEXTURE_MIN_FILTER,Te.NEAREST),Te.texImage2D(Te.TEXTURE_2D,0,Te.DEPTH_COMPONENT24,this.width,this.height,0,Te.DEPTH_COMPONENT,Te.UNSIGNED_INT,null),e}createNoiceTexture(e,t){const r=this.createTexture();return Te.texParameteri(Te.TEXTURE_2D,Te.TEXTURE_MAG_FILTER,Te.NEAREST),Te.texParameteri(Te.TEXTURE_2D,Te.TEXTURE_MIN_FILTER,Te.NEAREST),Te.texParameteri(Te.TEXTURE_2D,Te.TEXTURE_WRAP_S,Te.REPEAT),Te.texParameteri(Te.TEXTURE_2D,Te.TEXTURE_WRAP_T,Te.REPEAT),Te.texImage2D(Te.TEXTURE_2D,0,Te.RGB16F,e,e,0,Te.RGB,Te.FLOAT,t),r}buildScreenBuffer(){if(0===this.postprocessors.length)return!0;Te.getExtension("EXT_color_buffer_float"),Te.getExtension("OES_texture_float_linear");const e=this.postprocessors.map(e=>e.buildScreenBuffer(this)).map(e=>`#define ${e.name} ${e.value||1}`+"\n").join("");this.VAO=Te.createVertexArray(),Te.bindVertexArray(this.VAO);const t=Te.createBuffer();Te.bindBuffer(Te.ARRAY_BUFFER,t),Te.bufferData(Te.ARRAY_BUFFER,new Float32Array([1,1,-1,1,-1,-1,-1,-1,1,-1,1,1]),Te.STATIC_DRAW),Te.enableVertexAttribArray(0),Te.vertexAttribPointer(0,2,Te.FLOAT,!1,0,0),Te.bindVertexArray(null);const r=Te.createRenderbuffer();Te.bindRenderbuffer(Te.RENDERBUFFER,r),Te.renderbufferStorageMultisample(Te.RENDERBUFFER,this.MSAA,Te.RGBA8,this.width,this.height);const n=Te.createRenderbuffer();Te.bindRenderbuffer(Te.RENDERBUFFER,n),Te.renderbufferStorageMultisample(Te.RENDERBUFFER,this.MSAA,Te.RGBA16F,this.width,this.height);const s=Te.createRenderbuffer();return Te.bindRenderbuffer(Te.RENDERBUFFER,s),Te.renderbufferStorageMultisample(Te.RENDERBUFFER,this.MSAA,Te.DEPTH_COMPONENT24,this.width,this.height),this.renderframebuffer=Te.createFramebuffer(),Te.bindFramebuffer(Te.FRAMEBUFFER,this.renderframebuffer),Te.framebufferRenderbuffer(Te.FRAMEBUFFER,Te.COLOR_ATTACHMENT0,Te.RENDERBUFFER,r),Te.framebufferRenderbuffer(Te.FRAMEBUFFER,Te.COLOR_ATTACHMENT1,Te.RENDERBUFFER,n),Te.framebufferRenderbuffer(Te.FRAMEBUFFER,Te.DEPTH_ATTACHMENT,Te.RENDERBUFFER,s),Te.drawBuffers([Te.COLOR_ATTACHMENT0,Te.COLOR_ATTACHMENT1]),this.framebuffer=Te.createFramebuffer(),Te.bindFramebuffer(Te.FRAMEBUFFER,this.framebuffer),this.screenTexture=this.createByteTexture(),this.normalTexture=this.createDefaultTexture(),this.depthTexture=this.createDepthTexture(),Te.framebufferTexture2D(Te.FRAMEBUFFER,Te.COLOR_ATTACHMENT0,Te.TEXTURE_2D,this.screenTexture,0),Te.framebufferTexture2D(Te.FRAMEBUFFER,Te.COLOR_ATTACHMENT1,Te.TEXTURE_2D,this.normalTexture,0),Te.framebufferTexture2D(Te.FRAMEBUFFER,Te.DEPTH_ATTACHMENT,Te.TEXTURE_2D,this.depthTexture,0),Te.drawBuffers([Te.COLOR_ATTACHMENT0,Te.COLOR_ATTACHMENT1]),Te.bindFramebuffer(Te.FRAMEBUFFER,null),this.preframebuffer=Te.createFramebuffer(),Te.bindFramebuffer(Te.FRAMEBUFFER,this.preframebuffer),this.preDepthTexture=this.createDepthTexture(),Te.framebufferTexture2D(Te.FRAMEBUFFER,Te.DEPTH_ATTACHMENT,Te.TEXTURE_2D,this.preDepthTexture,0),Te.bindFramebuffer(Te.FRAMEBUFFER,null),this.program=Te.createProgram(),S(Te.VERTEX_SHADER,Q.a.replace(/\n/,`\n${e}`),this.program),S(Te.FRAGMENT_SHADER,Ae.a.replace(/\n/,`\n${e}`),this.program),Te.linkProgram(this.program),!0}clear(){console.error("implement")}}function xe(e,t,r){this.x=e,this.y=t,this.z=r}xe.prototype.dot2=function(e,t){return this.x*e+this.y*t},xe.prototype.dot3=function(e,t,r){return this.x*e+this.y*t+this.z*r};var ge=[new xe(1,1,0),new xe(-1,1,0),new xe(1,-1,0),new xe(-1,-1,0),new xe(1,0,1),new xe(-1,0,1),new xe(1,0,-1),new xe(-1,0,-1),new xe(0,1,1),new xe(0,-1,1),new xe(0,1,-1),new xe(0,-1,-1)],Re=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],ve=new Array(512),Fe=new Array(512);!function(e){e>0&&e<1&&(e*=65536),(e=Math.floor(e))<256&&(e|=e<<8);for(var t=0;t<256;t++){var r;r=1&t?Re[t]^255&e:Re[t]^e>>8&255,ve[t]=ve[t+256]=r,Fe[t]=Fe[t+256]=ge[r%12]}}(0);Math.sqrt(3),Math.sqrt(3);function Pe(e){return e*e*e*(e*(6*e-15)+10)}function we(e,t,r){return(1-r)*e+r*t}function Se(e,t,r){var n=Math.floor(e),s=Math.floor(t),i=Math.floor(r);e-=n,t-=s,r-=i;var o=Fe[(n&=255)+ve[(s&=255)+ve[i&=255]]].dot3(e,t,r),a=Fe[n+ve[s+ve[i+1]]].dot3(e,t,r-1),l=Fe[n+ve[s+1+ve[i]]].dot3(e,t-1,r),h=Fe[n+ve[s+1+ve[i+1]]].dot3(e,t-1,r-1),c=Fe[n+1+ve[s+ve[i]]].dot3(e-1,t,r),u=Fe[n+1+ve[s+ve[i+1]]].dot3(e-1,t,r-1),m=Fe[n+1+ve[s+1+ve[i]]].dot3(e-1,t-1,r),f=Fe[n+1+ve[s+1+ve[i+1]]].dot3(e-1,t-1,r-1),d=Pe(e),p=Pe(t),A=Pe(r);return we(we(we(o,c,d),we(a,u,d),A),we(we(l,m,d),we(h,f,d),A),p)}var ye=r(12),Ne=r.n(ye),Me=r(13),Be=r.n(Me),Ue=r(14),De=r.n(Ue),Le=r(15),Oe=r.n(Le);let We;const je=1e3;class ke{constructor(e){this.getLight=e}setGl(e){We=e}setCamera(e){this.camera=e}build(){this.currentSourceIdx=0;const e=We.createProgram();S(We.VERTEX_SHADER,Oe.a,e),S(We.FRAGMENT_SHADER,De.a,e);We.transformFeedbackVaryings(e,["v_position","v_velocity","v_spawntime","v_lifetime"],We.SEPARATE_ATTRIBS),We.linkProgram(e),this.program=e;const t=We.createProgram();S(We.VERTEX_SHADER,Ne.a,t),S(We.FRAGMENT_SHADER,Be.a,t),We.linkProgram(t),this.program2=t;const r=[We.createVertexArray(),We.createVertexArray()],n=[We.createTransformFeedback(),We.createTransformFeedback()];this.VAO=r,this.TFO=n;for(const e of[0,1]){We.bindVertexArray(r[e]);const t=[];{const e=new Float32Array(3*je);for(let t=0;t<je;t++)e[3*t]=0,e[3*t+1]=0,e[3*t+2]=0;const r=We.createBuffer();We.bindBuffer(We.ARRAY_BUFFER,r),We.bufferData(We.ARRAY_BUFFER,e,We.STREAM_COPY),We.enableVertexAttribArray(0),We.vertexAttribPointer(0,3,We.FLOAT,!1,0,0),We.vertexAttribDivisor(0,1),t.push(r)}{const e=new Float32Array(3*je);for(let t=0;t<je;t++)e[3*t]=0,e[3*t+1]=0,e[3*t+2]=0;const r=We.createBuffer();We.bindBuffer(We.ARRAY_BUFFER,r),We.bufferData(We.ARRAY_BUFFER,e,We.STREAM_COPY),We.enableVertexAttribArray(1),We.vertexAttribPointer(1,3,We.FLOAT,!1,0,0),We.vertexAttribDivisor(1,1),t.push(r)}{const e=new Float32Array(1*je);for(let t=0;t<je;t++)e[2*t]=0;const r=We.createBuffer();We.bindBuffer(We.ARRAY_BUFFER,r),We.bufferData(We.ARRAY_BUFFER,e,We.STREAM_COPY),We.enableVertexAttribArray(2),We.vertexAttribPointer(2,1,We.FLOAT,!1,0,0),We.vertexAttribDivisor(2,1),t.push(r)}{const e=new Float32Array(1*je);for(let t=0;t<je;t++)e[2*t]=0;const r=We.createBuffer();We.bindBuffer(We.ARRAY_BUFFER,r),We.bufferData(We.ARRAY_BUFFER,e,We.STREAM_COPY),We.enableVertexAttribArray(3),We.vertexAttribPointer(3,1,We.FLOAT,!1,0,0),We.vertexAttribDivisor(3,1),t.push(r)}We.bindBuffer(We.ARRAY_BUFFER,null),We.bindTransformFeedback(We.TRANSFORM_FEEDBACK,n[e]);let s=0;for(const e of t)We.bindBufferBase(We.TRANSFORM_FEEDBACK_BUFFER,s,e),s++}const s=new Uint8Array(2097152);for(var i=0;i<128;++i)for(var o=0;o<128;++o)for(var a=0;a<128;++a){var l=Se(a/8,o/8,i/8);l=128*(1+l),s[a+128*o+128*i*128]=l}return this.texture3d=We.createTexture(),this.texture3d.index=b(),We.activeTexture(We[`TEXTURE${this.texture3d.index}`]),We.bindTexture(We.TEXTURE_3D,this.texture3d),We.texParameteri(We.TEXTURE_3D,We.TEXTURE_BASE_LEVEL,0),We.texParameteri(We.TEXTURE_3D,We.TEXTURE_MAX_LEVEL,Math.log2(128)),We.texParameteri(We.TEXTURE_3D,We.TEXTURE_MIN_FILTER,We.LINEAR_MIPMAP_LINEAR),We.texParameteri(We.TEXTURE_3D,We.TEXTURE_MAG_FILTER,We.LINEAR),We.texImage3D(We.TEXTURE_3D,0,We.R8,128,128,128,0,We.RED,We.UNSIGNED_BYTE,s),We.generateMipmap(We.TEXTURE_3D),!0}draw(e){const t=(this.currentSourceIdx+1)%2;We.useProgram(this.program),We.bindVertexArray(this.VAO[this.currentSourceIdx]),We.bindTransformFeedback(We.TRANSFORM_FEEDBACK,this.TFO[t]);const r=new n;r.multiply(this.camera.projection),r.multiply(this.camera.matrixWorldInvert),We.uniform1f(We.getUniformLocation(this.program,"u_time"),e+5e3),We.uniform1f(We.getUniformLocation(this.program,"count"),je),We.uniform1i(We.getUniformLocation(this.program,"noize"),this.texture3d.index),We.enable(We.RASTERIZER_DISCARD),We.beginTransformFeedback(We.POINTS),We.drawArraysInstanced(We.POINTS,0,1,je),We.endTransformFeedback(),We.disable(We.RASTERIZER_DISCARD),We.bindTransformFeedback(We.TRANSFORM_FEEDBACK,null),We.bindBuffer(We.TRANSFORM_FEEDBACK_BUFFER,null);const s=We.fenceSync(We.SYNC_GPU_COMMANDS_COMPLETE,0);We.waitSync(s,0,We.TIMEOUT_IGNORED),We.deleteSync(s),We.useProgram(this.program2),We.bindVertexArray(this.VAO[t]),We.uniformMatrix4fv(We.getUniformLocation(this.program2,"MVPMatrix"),!1,r.elements),We.uniform1i(We.getUniformLocation(this.program2,"light"),this.getLight()),We.drawArraysInstanced(We.POINTS,0,1,je),this.currentSourceIdx=(this.currentSourceIdx+1)%2}}let Xe;r.d(t,"RedCube",function(){return Ie});class Ie{constructor(e,t,r){this.reflow=!0,this.scene=new f,this.canvas=t,this.processors=r,this.camera=new m,this.camera.setProps({type:"perspective",isInitial:!0,zoom:1,aspect:this.canvas.offsetWidth/this.canvas.offsetHeight,perspective:{yfov:.6}}),this.light=new d,this.events=new p(this.redraw.bind(this)),this.fps=new C,this.env=new V,this.env.setCamera(this.camera),this.PP=new be(r),this.PP.setLight(this.light),this.PP.setCanvas(this.canvas),this.PP.setCamera(this.camera),this.PP.setRender(this.renderScene.bind(this)),this.Particles=new ke(()=>{return this.PP.postprocessors.find(e=>e instanceof de).texture.index}),this.Particles.setCamera(this.camera);const n=[];0===r.length&&n.push({name:"TONE"}),this.parse=new K(e),this.parse.setScene(this.scene),this.parse.setCamera(this.camera),this.parse.setLight(this.light),this.parse.setUpdateCamera(this.updateCamera.bind(this)),this.parse.setCanvas(this.canvas),this.parse.setResize(this.resize.bind(this)),this.parse.setDefines(n)}init(){return this.parse.getJson().then(this.glInit.bind(this)).then(this.Particles.build.bind(this.Particles)).then(this.parse.initTextures.bind(this.parse)).then(this.PP.buildScreenBuffer.bind(this.PP)).then(this.parse.getBuffer.bind(this.parse)).then(this.parse.buildSkin.bind(this.parse)).then(this.parse.buildMesh.bind(this.parse)).then(this.parse.buildAnimation.bind(this.parse)).then(this.env.createEnvironmentBuffer.bind(this.env)).then(this.draw.bind(this)).catch(console.error)}updateCamera(e){this.camera=e,this.env.setCamera(e),this.PP.setCamera(e)}redraw(e,t,r){if("zoom"===e&&(this.camera.props.zoom=Math.max(Math.min(t,3/this.camera.props.aspect),.5),this.updateNF(),this.camera.setProjection(B(this.camera.props)),this.needUpdateProjection=!0),"rotate"===e){const e=M(t,this.camera.projection,this.canvas.offsetWidth,this.canvas.offsetHeight),i=M(r,this.camera.projection,this.canvas.offsetWidth,this.canvas.offsetHeight),o=new s(N(e)),a=new s(N(i)),l=5*s.angle(a,o);if(l<1e-6||isNaN(l))return;const h=new s(o.elements).applyMatrix4(this.camera.matrixWorld),c=new s(a.elements).applyMatrix4(this.camera.matrixWorld),u=s.cross(c,h).normalize(),m=new n;m.makeRotationAxis(u,l),m.multiply(this.camera.matrixWorld),this.camera.setMatrixWorld(m.elements),this.needUpdateView=!0}if("pan"===e){const e=M(t,this.camera.projection,this.canvas.offsetWidth,this.canvas.offsetHeight),n=M(r,this.camera.projection,this.canvas.offsetWidth,this.canvas.offsetHeight),i=new s([...e,0]),o=new s([...n,0]),a=100*this.camera.modelSize,l=o.subtract(i).scale(a);this.camera.matrixWorld.translate(l.elements[0],l.elements[1],0),this.camera.setMatrixWorld(this.camera.matrixWorld.elements),this.needUpdateView=!0}"resize"===e&&(this.resize(e),this.needUpdateProjection=!0),this.reflow=!0}updateNF(){const e=Math.abs(this.camera.matrixWorldInvert.elements[14]),t=this.camera.props.perspective||this.camera.props.orthographic;e>this.camera.modelSize?(t.znear=e-this.camera.modelSize,t.zfar=e+this.camera.modelSize):(t.znear=1,t.zfar=1e4),this.camera.setProjection(B(this.camera.props))}resize(e){if(this.camera.props.aspect=this.canvas.offsetWidth/this.canvas.offsetHeight,this.canvas.width=this.canvas.offsetWidth*devicePixelRatio,this.canvas.height=this.canvas.offsetHeight*devicePixelRatio,Xe.viewport(0,0,this.canvas.offsetWidth*devicePixelRatio,this.canvas.offsetHeight*devicePixelRatio),this.camera.props.isInitial){const e=1/this.canvas.width*this.camera.modelSize*3e3*devicePixelRatio;this.camera.setZ(e),this.light.setZ(e),this.light.update(Math.PI/2),this.needUpdateView=!0}else this.light.setZ(this.camera.matrixWorld.elements[14]),this.light.update(Math.PI/2),this.needUpdateView=!0;this.updateNF(),e&&(this.PP.clear(),this.PP.buildScreenBuffer())}glInit(){if(Xe=this.canvas.getContext("webgl2",{antialias:!1}),this.gl=Xe,!Xe)throw new Error("Webgl 2 doesnt support");return function(e){T=e;for(const e in T){const t=T[e];"number"==typeof t&&(A[t]=e)}}(Xe),this.env.setGl(Xe),this.PP.setGl(Xe),this.parse.setGl(Xe),this.Particles.setGl(Xe),!0}animate(e){for(const t of this.parse.tracks){const r=F(e,t.keys);if(-1===r[0]||-1===r[1]||t.stoped)continue;r[0]===t.keys.length-1&&(t.stoped=!0);const n=t.keys[r[0]],a=t.keys[r[1]],l=r[2],c=v(t.type);let f;3===c?f=s:4===c?f=i:2===c&&(f=o);const d=new f(n.value),p=new f(a.value);if("rotation"===t.type){const e=new i;e.lerp(d.elements,p.elements,l);for(const r of t.meshes)r.matrix.makeRotationFromQuaternion(e.elements)}else if("scale"===t.type){const e=new s;e.lerp(d.elements,p.elements,l);for(const r of t.meshes)r.matrix.scale(e)}else if("weights"===t.type){const e=new o;e.lerp(d.elements,p.elements,l);for(const r of t.meshes){const t={};for(const n in r.geometry.targets[0]){let s=0;t[n]=new Float32Array(r.geometry.attributes[n].length);for(let i=0;i<t[n].length;i++)"TANGENT"!==n||(i+1)%4!=0?t[n][i]=r.geometry.attributes[n][i]+e.elements[0]*r.geometry.targets[0][n][i-s]+e.elements[1]*r.geometry.targets[1][n][i-s]:s++}Xe.bindVertexArray(r.geometry.VAO);for(const e in t){const r=Xe.createBuffer();Xe.bindBuffer(Xe.ARRAY_BUFFER,r),Xe.bufferData(Xe.ARRAY_BUFFER,t[e],Xe.STATIC_DRAW);const n=D(e);Xe.enableVertexAttribArray(n[0]),Xe.vertexAttribPointer(n[0],n[1],n[2],!1,0,0)}Xe.bindVertexArray(null)}}else if("translation"===t.type){const e=new s;e.lerp(d.elements,p.elements,l);for(const r of t.meshes)r.matrix.setTranslate(e)}else console.error("ERROR");for(const e of t.meshes)y(e,e=>{e.updateMatrix(),e instanceof u&&(e.reflow=!0),e instanceof h&&(e.reflow=!0),e instanceof m&&e===this.camera&&(this.needUpdateView=!0)});this.reflow=!0}}draw(){Xe.clearColor(0,0,0,1),this.render()}render(e=0){const t=e/1e3;this.animate(t),this.reflow&&(this.reflow=!1,this.PP.postprocessors.length>0&&(this.PP.bindPrePass(),this.PP.preProcessing(),this.PP.bindPostPass()),Xe.clear(Xe.COLOR_BUFFER_BIT|Xe.DEPTH_BUFFER_BIT),this.env.createEnvironment(),this.renderScene(!this.processors.includes("shadow"),!1),this.PP.postprocessors.find(e=>e instanceof de)&&(this.Particles.draw(e),this.reflow=!0),y(this.scene,e=>{e.reflow=!1}),this.needUpdateView=!1,this.needUpdateProjection=!1,this.PP.postprocessors.length>0&&this.PP.postProcessing()),this.fps.tick(e),requestAnimationFrame(this.render.bind(this))}renderScene(e,t){if(Xe.enable(Xe.DEPTH_TEST),Xe.enable(Xe.CULL_FACE),this.needUpdateView){const e=a(this.camera.getViewProjMatrix());this.scene.meshes.forEach(t=>{t.visible=t.isVisible(e)})}this.scene.opaqueChildren.forEach(r=>{r.visible&&r.draw(Xe,this.getState(),e,t)}),this.scene.transparentChildren.length&&(Xe.enable(Xe.BLEND),Xe.depthMask(!1),Xe.blendFuncSeparate(Xe.SRC_COLOR,Xe.DST_COLOR,Xe.ONE,Xe.ZERO),this.scene.transparentChildren.forEach(r=>{r.visible&&r.draw(Xe,this.getState(),e,t)}),Xe.disable(Xe.BLEND),Xe.depthMask(!0),Xe.blendFuncSeparate(Xe.ONE,Xe.ZERO,Xe.ONE,Xe.ZERO))}getState(){return{camera:this.camera,light:this.light,preDepthTexture:this.PP.preDepthTexture,fakeDepth:this.PP.fakeDepth,needUpdateView:this.needUpdateView,needUpdateProjection:this.needUpdateProjection}}}}])});
//# sourceMappingURL=redcube.js.map